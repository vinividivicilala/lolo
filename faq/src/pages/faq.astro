---
import Layout from '../layouts/Layout.astro';
import FAQItem from '../components/FAQItem.astro';

// Data FAQ untuk ditampilkan
const faqData = [
  {
    id: 1,
    index: "1",
    icon: "ðŸš€",
    question: "Apa itu Astro?",
    answer: "Astro adalah framework modern untuk membangun website statis dan hybrid yang super cepat.",
    fullDescription: "Astro adalah framework web all-in-one yang dirancang untuk membuat website cepat dan efisien...",
    category: "Pengenalan",
    lastUpdated: "15 November 2023, 14:30 WIB",
    isNew: true,
    labelColor: "blue",
    topic: "Dasar-Dasar Astro"
  },
  {
    id: 2,
    index: "2",
    icon: "ðŸ“‚",
    question: "Di mana letak gambar?",
    answer: "Gambar disimpan di folder /public/images.",
    fullDescription: "Dalam proyek Astro, semua aset statis seperti gambar, font, dan file lainnya disimpan...",
    category: "Struktur Proyek",
    lastUpdated: "12 November 2023, 09:15 WIB",
    isNew: true,
    labelColor: "green",
    topic: "Dasar-Dasar Astro"
  }
  // tambahkan data lain sesuai kebutuhan
];
---

<Layout title="FAQ | Astro Example" description="Halaman FAQ dengan animasi, gambar, dan icon." currentPage="faq">
  <div class="container">
    <main class="main-content">
      <h1 class="page-title">FREQUENTLY ASKED</h1>
      <div class="faq-topics">
        <div class="faq-items">
          {faqData.map((faq) => (
            <div data-framer class="faq-item-wrapper" data-faq-id={faq.id}>
              {faq.isNew && (
                <div class={`new-label ${faq.labelColor}`}>
                  <span class="new-label-text">BARU</span>
                </div>
              )}
              <FAQItem 
                index={faq.index} 
                icon={faq.icon} 
                question={faq.question}
                answer={faq.answer}
              />
            </div>
          ))}
        </div>
      </div>
    </main>
  </div>

  <!-- Modal FAQ -->
  <div id="faqModal" class="modal">
    <div class="modal-content large-modal">
      <span class="close">&times;</span>
      <div id="modalContent"></div>
    </div>
  </div>
</Layout>

<style>
/* Modal Styles */
.modal {
  display: none;
  position: fixed;
  z-index: 1000;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0, 0, 0, 0.6);
}

.modal-content {
  background-color: #fff;
  margin: 2% auto;
  padding: 40px;
  border: 3px solid #000;
  width: 92%;
  max-width: 1100px;
  border-radius: 12px;
  box-shadow: 0 20px 50px rgba(0,0,0,0.3);
  position: relative;
  max-height: 90vh;
  overflow-y: auto;
}

.close {
  color: #aaa;
  position: absolute;
  top: 25px;
  right: 30px;
  font-size: 36px;
  font-weight: bold;
  cursor: pointer;
}

.close:hover { color: #000; }

/* Section wrapper untuk tiap blok */
.modal-section { margin-bottom: 25px; }

/* Judul FAQ */
.modal-title {
  font-size: 2.5rem;
  font-weight: 700;
  border: 3px solid #000;
  padding: 20px;
  border-radius: 8px;
  background: #f8fafc;
}

/* Tanggal & Jam */
.modal-meta {
  font-size: 1.4rem;
  font-weight: 700;
  border: 3px solid #000;
  padding: 15px;
  border-radius: 8px;
  background: #f1f5f9;
}

/* Label Baru */
.modal-status {
  display: inline-block;
  font-size: 1.4rem;
  font-weight: 700;
  border: 3px solid #000;
  padding: 12px 20px;
  border-radius: 8px;
  background: #ef4444;
  color: #fff;
}

/* Deskripsi */
.modal-description {
  font-size: 1.3rem;
  font-weight: 700;
  line-height: 1.8;
  border: 3px solid #000;
  padding: 25px;
  border-radius: 8px;
  background: #f8fafc;
}

/* Timeline */
.modal-timeline {
  border: 3px solid #000;
  border-radius: 8px;
  padding: 30px;
  background: #f8fafc;
}

.timeline-item {
  margin-bottom: 25px;
  padding: 15px;
  border: 2px dashed #000;
  border-radius: 6px;
  background: white;
}

.timeline-title {
  font-weight: 700;
  font-size: 1.5rem;
  margin-bottom: 10px;
  border-bottom: 2px solid #000;
  padding-bottom: 5px;
}

.timeline-content { font-size: 1.2rem; }
</style>

<script>
  // Ambil data dari server (Astro frontmatter) â†’ serialize ke JS
  const faq = Astro.serialize(faqData);

  function openFAQModal(id) {
    const item = faq.find(f => f.id === id);
    if (!item) return;

    const modal = document.getElementById("faqModal");
    const modalContent = document.getElementById("modalContent");

    modalContent.innerHTML = `
      <div class="modal-faq-content">
        <div class="modal-section">
          <h2 class="modal-title">${item.question}</h2>
        </div>

        <div class="modal-section">
          <div class="modal-meta">ðŸ•’ ${item.lastUpdated}</div>
        </div>

        ${item.isNew ? `
        <div class="modal-section">
          <div class="modal-status">ðŸ†• BARU</div>
        </div>` : ""}

        <div class="modal-section">
          <div class="modal-description">
            ${item.fullDescription.replace(/\\n/g, "<br>")}
          </div>
        </div>

        <div class="modal-section">
          <div class="modal-timeline">
            <div class="timeline-item">
              <div class="timeline-title">Keuntungan Menggunakan Astro</div>
              <div class="timeline-content">Astro menawarkan performa luar biasa dengan mengirimkan HTML statis.</div>
            </div>
            <div class="timeline-item">
              <div class="timeline-title">Kompatibilitas Framework</div>
              <div class="timeline-content">Dukung multiple framework UI dalam satu proyek tanpa konflik.</div>
            </div>
            <div class="timeline-item">
              <div class="timeline-title">Optimasi Built-in</div>
              <div class="timeline-content">Astro secara otomatis mengoptimalkan gambar, CSS, dan JavaScript.</div>
            </div>
          </div>
        </div>
      </div>
    `;

    modal.style.display = "block";
  }

  document.addEventListener("DOMContentLoaded", () => {
    const modal = document.getElementById("faqModal");
    const closeBtn = document.querySelector(".close");

    document.querySelectorAll(".faq-item-wrapper").forEach(el => {
      el.addEventListener("click", () => {
        openFAQModal(parseInt(el.dataset.faqId));
      });
    });

    closeBtn.onclick = () => (modal.style.display = "none");
    window.onclick = e => { if (e.target === modal) modal.style.display = "none"; };
  });
</script>
