<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üìù Noted</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: 'Inter', sans-serif;
      background: #f9fafb;
      padding: 50px 20px;
      color: #111827;
	  background-image: 
    linear-gradient(to right, #eee 1px, transparent 1px),
    linear-gradient(to bottom, #eee 1px, transparent 1px);
  background-size: 30px 30px;
  background-color: #fafafa;

    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
      font-size: 28px;
      font-weight: 600;
      color: #111827;
	  margin-top: 30px;
	  
    }
	
        input[type="text"] {
            flex: 1;
            padding: 14px 18px;
            border: 1px solid #d1d5db;
            border-radius: 12px;
            font-size: 16px;
            background: #fff;
            transition: border 0.3s ease;
        }
        input[type="text"]:focus {
            border-color: #3b82f6;
            outline: none;
        }
        button {
            background-color: #3b82f6;
            padding: 14px 20px;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            font-size: 15px;
            border: none;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.2s;
        }
        button:hover {
            background-color: #2563eb;
            transform: scale(1.03);
        }
        .note-card {
            background: white;
            max-width: 640px;
            margin: 0 auto 20px;
            border-radius: 14px;
            padding: 20px 24px 20px 60px;
            display: flex;
            align-items: center;
            position: relative;
            box-shadow: 0 6px 16px rgba(0,0,0,0.04);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .note-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 24px rgba(0,0,0,0.06);
        }
        .note-card::before {
            content: '';
            position: absolute;
            left: 30px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #e5e7eb;
        }
        .timeline-dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            border: 3px solid #9ca3af;
            background: #f3f4f6;
            position: absolute;
            left: 23px;
            top: 22px;
            z-index: 1;
            transition: all 0.3s ease;
        }
        .timeline-dot.active {
            background: #3b82f6;
            border-color: #3b82f6;
            animation: blink 1.2s infinite;
        }
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .note-text {
            flex: 1;
            font-size: 16px;
            line-height: 1.6;
            color: #1f2937;
            word-break: break-word;
            white-space: pre-wrap;
        }
        .arrow {
            margin-left: 12px;
            opacity: 0.5;
        }
        .arrow svg {
            width: 20px;
            height: 20px;
        }
        .popup {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 14px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            font-weight: 500;
            opacity: 0;
            pointer-events: none;
            transition: all 0.4s ease;
            z-index: 1000;
        }
        .popup.show {
            opacity: 1;
            pointer-events: auto;
        }
        .topic-filter {
            display: flex;
            max-width: 640px;
            margin: 0 auto 20px;
            gap: 10px;
            overflow-x: auto; /* Jika topik terlalu banyak */
        }
        .topic-button {
            background-color: #e5e7eb;
            color: #374151;
            padding: 8px 16px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .topic-button.active {
            background-color: #3b82f6;
            color: white;
        }
        .topic-button:hover {
            background-color: #d1d5db;
        }
        .note-group {
            margin-bottom: 30px;
        }
        .note-group h2 {
            font-size: 20px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 10px;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 5px;
        }
        .empty-topic {
            text-align: center;
            color: #6b7280;
            font-style: italic;
            margin-top: 20px;
        }
        .guide-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            z-index: 1001;
            max-width: 500px;
            text-align: center;
        }
        .guide-popup h3 {
            margin-top: 0;
            color: #3b82f6;
            margin-bottom: 10px;
        }
        .guide-popup p {
            line-height: 1.6;
            color: #4b5563;
            margin-bottom: 15px;
        }
        .guide-popup a {
            color: #2563eb;
            text-decoration: none;
            font-weight: 500;
        }
        .guide-popup button {
            background-color: #6b7280;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s ease;
        }
        .guide-popup button:hover {
            background-color: #4b5563;
        }
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
        }
        .guide-popup, .overlay {
            display: none; /* Initially hidden */
        }
        .guide-popup.show, .overlay.show {
            display: block;
        }
		
		
	.modal-content {
    background: white;
    padding: 30px; /* Tambah atau sesuaikan padding */
    border-radius: 16px; /* Sesuaikan radius sudut */
    max-width: 700px; /* Perbesar lebar maksimum */
    width: 90%; /* Atau gunakan persentase untuk responsif */
    text-align: left;
    position: relative;
    box-shadow: 0 15px 40px rgba(0,0,0,0.3); /* Efek bayangan lebih kuat untuk menonjol */
    transform: scale(1.05); /* Sedikit diperbesar saat muncul */
    transition: transform 0.3s ease-in-out; /* Animasi halus saat muncul */
}

/* Tambahkan style untuk overlay jika belum ada */
.modal-overlay {
    display: flex; /* Menggunakan flex agar konten di tengah */
    justify-content: center; /* Tengah horizontal */
    align-items: center; /* Tengah vertikal */
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.6); /* Latar belakang lebih gelap jika diinginkan */
    z-index: 1002;
}	
		
		
.close-btn {
  position: absolute;
  top: 10px; right: 15px;
  background: none;
  border: none;
  font-size: 20px;
  cursor: pointer;
}

    .info-card-container {
      display: flex;
      gap: 1.5rem;
      flex-wrap: wrap;
      justify-content: center;
    }

    .info-card {
      width: 400px;
      height: 100px;
      padding: 1rem;
      border-radius: 28px;
      color: white;
      position: relative;
      cursor: pointer;
      box-shadow: 0 4px 14px rgba(0,0,0,0.1);
      transition: transform 0.2s;
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .info-card:hover {
      transform: translateY(-6px);
    }

    .info-arrow-icon {
      position: absolute;
      top: 12px;
      right: 12px;
      width: 80px;
      height: 80px;
      fill: black;
    }

    .info-icon {
	   font-size: 39px;
    }

    .info-ketentuan { background-color: #007BFF; }
    .info-tentang { background-color: #28a745; }
    .info-privasi { background-color: #dc3545; }

    .info-popup {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.65);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .info-popup-content {
      background: #fff;
      border-radius: 12px;
      max-width: 650px;
      width: 90%;
      padding: 2rem;
      position: relative;
      max-height: 85vh;
      overflow-y: auto;
      animation: fadeIn 0.3s ease;
      scroll-behavior: smooth;
      font-size: 29px;
    }

    .info-popup-content h2 {
      margin-top: 0;
      display: flex;
      align-items: center;
      gap: 0.5rem;
	      color: black;
	     text-align: left;
    }

    .info-content-block {
      padding: 1rem;
      border-radius: 10px;
      margin-bottom: 1rem;
    }

    .info-blue-block { background: #e3f2fd; }
    .info-yellow-block { background: #fff3cd; }
    .info-red-block { background: #f8d7da; }
    .info-green-block { background: #e6f4ea; }
    .info-pink-block { background: #fdecef; }

    .info-content-block p {
      margin: 0.5rem 0;
	      color: black;
	     text-align: left;
    }

    .info-content-block img {
      max-width: 100%;
      border-radius: 8px;
      margin: 1rem 0;
    }
	  .info-close-btn {
      position: absolute;
      top: 12px;
      right: 16px;
      font-size: 22px;
      cursor: pointer;
      color: #999;
    }

    .info-close-btn:hover {
      color: #000;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    a {
      color: #007bff;
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    ::-webkit-scrollbar {
      width: 8px;
    }
	  ::-webkit-scrollbar-thumb {
      background: #bbb;
      border-radius: 4px;
    }

.user-card {
  padding: 15px;
  margin-bottom: 15px;
  border-radius: 10px;
  box-shadow: 0 0 4px rgba(0,0,0,0.1);
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-family: sans-serif;
  font-size: 16px;
  font-weight: bold;
}

.admin-border {
  border-left: 6px solid #e74c3c;
}

.kontributor-border {
  border-left: 6px solid #f39c12;
}

.member-border {
  border-left: 6px solid #3498db;
}

/* Badge */
.badge {
  padding: 5px 12px;
  border-radius: 999px;
  font-size: 12px;
  font-weight: bold;
  color: #fff;
  cursor: pointer;
}

.admin { background-color: #e74c3c; }
.kontributor { background-color: #f39c12; }
.member { background-color: #3498db; }

/* Role Popup */
.role-popup-overlay {
  display: none;
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.5);
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.role-popup-overlay.show {
  display: flex;
}

.role-popup-box {
  background: #fff;
  padding: 20px 30px;
  border-radius: 12px;
  max-width: 400px;
  text-align: center;
  box-shadow: 0 0 25px rgba(0,0,0,0.2);
}

.role-popup-box .close-btn {
  margin-top: 15px;
  padding: 6px 14px;
  border: none;
  background-color: #eee;
  cursor: pointer;
  border-radius: 6px;
  font-weight: bold;
}


    .activity-table {
        border-collapse: collapse;
        font-family: sans-serif;
        font-size: 11px;
    }

    .activity-table th, .activity-table td {
        border: 1px solid #eee;
        padding: 2px;
        text-align: center;
    }

    .activity-legend {
        margin-top: 5px;
        font-size: 10px;
        color: #586069;
    }

    .activity-legend span {
        display: inline-block;
        width: 10px;
        height: 10px;
        border: 1px solid #eee;
        margin: 0 5px;
    }
	
	.activity-new {
    background-color: #ccf2ff; /* Biru muda */
}

.activity-completed {
    background-color: #aaff80; /* Hijau muda */
}

.activity-revision {
    background-color: #ffdd99; /* Kuning muda */
}

.note-actions {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-top: 5px;
}

.save-individual-note {
    padding: 5px 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    background-color: red;
    cursor: pointer;
    font-size: 0.8em;
}

.save-individual-note:hover {
    background-color: green;
}



#saveBtn {
    padding: 10px 15px;
    border: none;
    background-color: #007bff;
    color: white;
    border-radius: 5px;
    cursor: pointer;
    font-size: 1em;
}

#saveBtn:hover {
    background-color: #0056b3;
}


  .voice-icon-btn {
            /* Gaya dasar tombol */
            padding: 10px;
            border: none;
            background-color: transparent;
            cursor: pointer;
            outline: none; /* Hapus outline saat fokus */
            transition: transform 0.2s ease-in-out, color 0.2s ease-in-out;
            font-size: 0; /* Sembunyikan teks default jika ada */
        }

        .voice-icon-btn svg {
            display: block; /* Membuat SVG berperilaku seperti blok */
            width: 32px; /* Ukuran ikon lebih besar */
            height: 32px;
            fill: #3498db; /* Warna ikon standar */
        }

        .voice-icon-btn.active {
            transform: scale(1.1);
            color: red; /* Indikasi sedang mendengarkan */
            fill: red; /* Warna ikon saat aktif */
        }

        #noteInput {
            margin-top: 20px;
            padding: 10px;
            width: 80%;
            max-width: 400px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-size: 16px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        #waveformCanvas {
            margin-top: 15px;
            border: 1px solid #ddd;
            background-color: #e9e9e9;
            display: block; /* Memastikan mengambil baris sendiri */
            border-radius: 8px;
        }

        #voicePlaybackContainer {
            margin-top: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 40px; /* Beri ruang bahkan saat kosong */
            width: 100%;
        }

        #voicePlaybackContainer audio {
            width: 100%;
            max-width: 350px; /* Ukuran audio player */
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .note-display {
            margin-top: 25px;
            padding: 15px;
            background-color: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            width: 80%;
            max-width: 500px;
            text-align: center;
            color: #555;
            word-wrap: break-word; /* Memastikan teks tidak meluber */
        }


















.pin-button {
    background-color: transparent;
    border: 1px solid #ccc;
    border-radius: 5px;
    padding: 5px 10px;
    cursor: pointer;
    font-size: 0.8em;
}

.pin-button:hover {
    background-color: #eee;
}




  .cookie-notification {
    position: fixed;
    bottom: 20px; /* Ubah dari 'bottom: 0' menjadi 'bottom: 20px' (atau nilai lain sesuai keinginan) */
    left: 0;
    background-color: #222;
    color: #fff;
    padding: 10px;
    text-align: center;
    z-index: 1000;
    display: inline-block; /* Atau fit-content */
    border-radius: 5px; /* Opsional */
    line-height: 1.5; /* Opsional */
  }
  
  .cookie-list-number {
    color: #fff; /* Warna teks nomor menjadi putih agar kontras dengan latar belakang */
    padding: 2px 6px;
    border-radius: 4px; /* Membuat sudut sedikit melengkung */
    margin-right: 5px; /* Memberikan sedikit jarak antara nomor dan teks */
    font-weight: bold; /* Membuat nomor lebih tebal */
}

        .filter-container {
            margin-bottom: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        label {
            margin-right: 10px;
        }

        select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 3px;
        }


#notificationPopup {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    display: none;
    z-index: 1000;
    overflow-y: auto;
}

#notificationPopup > div {
    background-color: white;
    width: 90%;
    max-width: 500px;
    border-radius: 8px;
    margin: 50px auto;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    position: relative;
    top: 50%;
    transform: translateY(-50%);
}

#notificationPopup .header {
    padding: 10px;
    border-bottom: 1px solid #eee;
    font-weight: bold;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

#notificationPopup .header span {
    font-size: 1.2em;
}

#notificationPopup #closeNotificationPopup {
    border: none;
    background: none;
    font-size: 1.5em;
    cursor: pointer;
    color: #888;
}

#notificationPopup #closeNotificationPopup:hover {
    color: #333;
}

#notificationListItems li {
    padding: 15px;
    border-bottom: 1px solid #eee;
    cursor: pointer;
    font-size: 0.9em;
}

#notificationListItems li:last-child {
    border-bottom: none;
}

#notificationListItems li:hover {
    background-color: #f9f9f9;
}

.notification-item {
    padding: 15px;
    border-bottom: 1px solid #eee;
    cursor: pointer;
    font-size: 0.9em;
    display: flex;
    align-items: center;
    flex-direction: column; /* Stack title and content vertically */
    align-items: flex-start; /* Align items to the start (left) */
}

.notification-item:last-child {
    border-bottom: none;
}

.notification-item:hover {
    background-color: #f9f9f9;
}

.notification-category {
    margin-right: 5px;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.8em;
    font-weight: bold;
}

.notification-title {
    font-size: 1em;
    font-weight: bold;
    margin-bottom: 5px; /* Add some space between title and content */
    color: #333; /* Make title color darker */
    display: block; /* Ensure it takes full width */
    text-align: left; /* Align title to the left */
}

.notification-content {
    font-size: 0.9em;
    color: #555; /* Lighter color for content */
    display: block;
    text-align: left; /* Align content to the left */
}


#markAllRead {
    background-color: #f0f0f0;
    border: none;
    padding: 8px 15px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 0.9em;
}

#markAllRead:hover {
    background-color: #e0e0e0;
}

#notificationFullContent {
    display: none;
    padding: 15px;
    border-top: 1px solid #eee;
}
      .blog-title {
        font-size: 35px;
        font-weight: bold;
        color: #1f2937;
        margin-bottom: 6px;
        margin-top: 0;
        line-height: 1.4;
        cursor: pointer;
        font-family: 'Poppins', sans-serif;
      }

      .blog-category-title {
        font-size: 24px;
        font-weight: bold;
        color: #111827;
        margin-bottom: 10px;
        text-align: left;
        margin-top: 40px;
      }

      .blog-category {
        font-size: 12px;
        color: #6b7280;
        margin-bottom: 0;
        text-transform: uppercase;
        font-weight: 700;
        margin-left: 0;
      }

      .blog-arrow {
        opacity: 0.7;
      }

      .blog-arrow svg {
        width: 20px;
        height: 20px;
      }

	  .blog-content-main-title {
  font-size: 39px; /* Ukuran font lebih besar */
  font-weight: bold; /* Teks tebal (hitam) */
  color: black; /* Warna teks hitam atau abu-abu gelap */
  margin-bottom: 0.5em; /* Jarak bawah dari judul */
}

.blog-content-meta {
  font-size: 15px; /* Ukuran font untuk meta informasi */
  color: black; /* Warna teks abu-abu */
  margin-bottom: 1em; /* Jarak bawah dari meta informasi */
}

.blog-content-meta span {
  margin-right: 1em; /* Jarak antar tanggal dan sumber */
}

.blog-content-text {
  color: black; /* Warna teks isi konten */
  line-height: 1.6; /* Jarak antar baris untuk keterbacaan */
}

      #closeBlogContent {
        background-color: transparent;
        color: black;
        padding: 10px 15px;
        border-radius: 8px;
        border: none;
        cursor: pointer;
        font-size: 29px;
        margin-top: 15px;
      }

      #closeBlogContent:hover {
        background-color: transparent;
      }

      .category-container {
        display: flex;
        flex-direction: row;
        align-items: baseline;
        width: 100%;
        justify-content: space-between;
        margin-bottom: 0;
      }

      .category-divider {
        border-top: 1px solid #e5e7eb;
        margin-top: 20px;
        padding-top: 20px;
      }

      .article-list {
        margin-bottom: 20px;
      }

      .article-item {
        margin-bottom: 20px;
        padding-bottom: 0;
        border-bottom: none;
      }

      .article-item:last-child {
        border-bottom: none;
        margin-bottom: 0;
        padding-bottom: 0;
      }
      .blog-date{
        color: #6b7280;
        font-size: 14px;
      }
      .blog-source{
        color: #6b7280;
        font-size: 12px;
      }

      /* Pagination Styles */
      .pagination {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 20px;
        padding: 0 10px;
      }

      .pagination-list {
        display: flex;
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .pagination-item {
        margin: 0 5px;
      }

      .pagination-link {
        display: block;
        padding: 8px 12px;
        text-decoration: none;
        color: #1f2937;
        border-radius: 4px;
        transition:  0.3s ease;
      }

      .pagination-link:hover {
        background-color: #f3f4f6;
      }

      .pagination-item.active .pagination-link {
        color: #6b7280;
        font-weight: bold;
        text-decoration: underline;
      }

      .pagination-next {
        margin-left: auto;
      }

      .pagination-next-link {
        display: block;
        padding: 8px 12px;
        text-decoration: none;
        color: #1f2937;
        border-radius: 4px;
        transition:  0.3s ease;
        font-weight: bold;
        text-decoration: underline;
      }

      .pagination-next-link:hover {
        background-color: #transparent;
      }





#quoraPopup {
    /* Style dasar popup sudah ada di HTML */
    width: 80%; /* Lebar popup */
    max-width: 500px;
    border-radius: 8px;
}

#quoraPopup h2 {
    color: #333;
    margin-top: 0;
    margin-bottom: 15px;
    border-bottom: 2px solid #eee;
    padding-bottom: 8px;
}

#quoraPopup ul {
    list-style-type: none; /* Hilangkan bullet points */
    padding: 0;
    margin-bottom: 15px;
}

#quoraPopup ul li {
    padding: 8px 0;
    border-bottom: 1px dashed #ddd;
}

#quoraPopup ul li:last-child {
    border-bottom: none;
}

#quoraPopup button#closeQuoraPopup {
    background-color: #f44336; /* Warna merah untuk tombol tutup */
    color: white;
    padding: 10px 15px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 1em;
    transition: background-color 0.3s ease;
}

#quoraPopup button#closeQuoraPopup:hover {
    background-color: #d32f2f; /* Warna merah lebih gelap saat hover */
}

#quoraPopup ul li h3 a:hover {
    text-decoration: underline; /* Tambahkan garis bawah saat hover pada judul tautan */
}

/* Gaya untuk Placeholder Video */
#youtube-placeholder {
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: #333;
    color: #fff;
    cursor: pointer;
    border-radius: 5px;
    margin-top: 10px;
}

#youtube-placeholder svg {
    width: 60px;
    height: 40px;
    fill: white;
    filter: drop-shadow(0 0 6px rgba(0,0,0,0.6));
}

#youtube-placeholder:hover {
    opacity: 0.9;
}

   
            #app {
            display: flex;
            flex-direction: column;
            width: 100%;
            max-width: 800px;
            background: #7FFF00;
            border-radius: 10px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: max-width 0.5s ease;
        }

        #loginForm {
            padding: 2rem;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 0.5s ease, transform 0.5s ease;
            opacity: 1;
            transform: translateX(0);
            width: 100%;
            box-sizing: border-box;
        }

        #loginForm h2 {
            margin-bottom: 1.5rem;
            color: #1a202c;
            font-weight: 600;
            font-size: 1.875rem;
        }

        .input-group {
            margin-bottom: 1rem;
            width: 100%;
        }

        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #4a5568;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .input-group input {
            width: calc(100% - 2rem);
            padding: 0.75rem 1rem;
            border: 1px solid #e2e8f0;
            border-radius: 0.375rem;
            font-size: 1rem;
            transition: border-color 0.2s ease;
            box-sizing: border-box;
        }

        .input-group input:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.15);
        }

        #errorMessage {
            margin-top: 1rem;
            color: #e53e3e;
            font-size: 0.875rem;
            padding: 0.5rem;
            background-color: #fed7d7;
            border-radius: 0.375rem;
            border: 1px solid #fecaca;
            display: none;
        }

        #loginForm button {
            padding: 0.75rem 1.5rem;
            background-color: #4299e1;
            color: white;
            border: none;
            border-radius: 0.375rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.2s ease;
            width: 100%;
            margin-top: 0.5rem;
        }

        #loginForm button:hover {
            background-color: #3182ce;
            transform: translateY(-2px);
        }

#greetingDiv {
    padding: 2rem;
    background-color: rgba(255, 255, 255, 0.8);
    border-radius: 10px;
    text-align: center;
    transition: all 0.5s ease;
    width: 100%;
    box-sizing: border-box;
    opacity: 0; /* Tetap 0 secara default */
    transform: translateX(100%); /* Tetap di luar layar default */
}


        #greetingDiv h2 {
            margin-bottom: 1rem;
            color: #1a202c;
            font-size: 1.875rem;
            font-weight: 600;
        }

        #greetingDiv p {
            color: #4a5568;
            font-size: 1rem;
            margin-bottom: 1.5rem;
        }

        #greetingDiv button {
            padding: 0.75rem 1.5rem;
            background-color: #e53e3e;
            color: white;
            border: none;
            border-radius: 0.375rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.2s ease;
            margin-top: 0.5rem;
        }

        #greetingDiv button:hover {
            background-color: #c53030;
            transform: translateY(-2px);
        }

        .dashboard-container {
    padding: 2rem;
    background-color: rgba(255, 255, 255, 0.8);
    border-radius: 10px;
    text-align: left;
    transition: all 0.5s ease;
    width: 100%;
    box-sizing: border-box;
    opacity: 0; /* Tetap 0 secara default */
    transform: translateY(20px); /* Tetap di bawah default */
}
        .dashboard-container h2 {
            margin-bottom: 1.5rem;
            color: black;
            font-size: 1.875rem;
            font-weight: 600;
        }

        .dashboard-greeting {
            font-size: 1.25rem;
            color: black;
            margin-bottom: 1rem;
            font-weight: 500;
        }

        .help-section {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid #e2e8f0;
        }

        .help-section h3 {
            font-size: 1.125rem;
            color: black;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .help-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .help-list li {
            display: flex;
            align-items: center;
            margin-bottom: 0.75rem;
            color: black;
        }

        .help-list li svg {
            margin-right: 0.75rem;
            width: 1.25rem;
            height: 1.25rem;
            color: #4299e1;
        }
		
		@media (min-width: 768px) {
    #app {
        max-width: 800px;
        flex-direction: row;
    }

    #loginForm,
    #greetingDiv,
    .dashboard-container {
        width: 50%;
        margin: 0;
    }

    #loginForm {
        border-radius: 10px 0 0 10px;
    }

    #greetingDiv,
    .dashboard-container {
        border-radius: 0 10px 10px 0;
    }
}

      

.slide-in {
    animation: slideIn 0.5s ease forwards;
}



.slide-out {
    animation: slideOut 0.5s ease forwards;
}

@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateX(100%); /* Untuk greetingDiv */
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

/* Tambahkan keyframes khusus untuk slide-in dashboard dari bawah */
@keyframes slideInDashboard {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.dashboard-container.slide-in { /* Terapkan animasi slideInDashboard ke dashboard */
    animation: slideInDashboard 0.5s ease forwards;
}

.slide-out {
    animation: slideOut 0.5s ease forwards;
}

@keyframes slideOut {
    from {
        opacity: 1;
        transform: translateX(0); /* Untuk greetingDiv */
    }
    to {
        opacity: 0;
        transform: translateX(-100%);
    }
}

.dashboard-container.slide-out { /* Atur animasi slideOut untuk dashboard */
    from {
        opacity: 1;
        transform: translateY(0);
    }
    to {
        opacity: 0;
        transform: translateY(20px);
    }
}

.hidden {
    visibility: hidden;
    opacity: 0;
    position: absolute;
    left: -9999px;
}


    /* Note Favorit */
    #notesArea input[type="text"] {
      width: calc(100% - 90px);
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      margin-right: 10px;
    }
    #notesArea button {
      padding: 10px 15px;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .note-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid #eee;
    }
    .favorite-icon {
      cursor: pointer;
      font-size: 20px;
    }

    /* Kotak Pesan */
    #messageBox {
      max-height: 200px;
      overflow-y: auto;
      border: 1px solid #ccc;
      padding: 10px;
      border-radius: 6px;
      margin-top: 10px;
      background: #fafafa;
    }
    #messageInput {
      width: calc(100% - 70px);
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      margin-right: 10px;
    }
    #sendMessageBtn {
      padding: 10px 15px;
      background: #2196F3;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    /* Pengaturan */
    .setting-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    /* Dark Mode */
    body.dark-mode {
      background: #1e1e1e;
      color: #f1f1f1;
    }
    body.dark-mode .section {
      background: #2d2d2d;
      color: #f1f1f1;
    }
    body.dark-mode .note-item,
    body.dark-mode #messageBox {
      background: #3a3a3a;
    }
	.section {
      background: white;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
    }
	
	 ul {
      list-style-type: none;
      padding-left: 0;
    }

    li {
      padding: 10px 0;
      border-bottom: 1px solid #e2e8f0;
    }

    li:last-child {
      border-bottom: none;
    }

    .icon {
      margin-right: 10px;
      font-size: 18px;
      color: #6b7280;
    }
	
	#app {
    display: flex;
    flex-direction: column;
    width: 100%;
    max-width: 800px;
    background: #7FFF00;
    border-radius: 10px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    transition: max-width 0.5s ease;
    margin: 20px auto; /* Agar app berada di tengah dan ada margin atas bawah */
}

#loginForm {
    padding: 2rem;
    background-color: rgba(255, 255, 255, 0.8);
    border-radius: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    transition: opacity 0.5s ease, transform 0.5s ease;
    opacity: 1;
    transform: translateX(0);
    width: 100%;
    box-sizing: border-box;
}

#loginForm h2 {
    margin-bottom: 1.5rem;
    color: #1a202c;
    font-weight: 600;
    font-size: 1.875rem;
}

.input-group {
    margin-bottom: 1rem;
    width: 100%;
}

.input-group label {
    display: block;
    margin-bottom: 0.5rem;
    color: #4a5568;
    font-size: 0.875rem;
    font-weight: 600;
}

.input-group input {
    width: calc(100% - 2rem);
    padding: 0.75rem 1rem;
    border: 1px solid #e2e8f0;
    border-radius: 0.375rem;
    font-size: 1rem;
    transition: border-color 0.2s ease;
    box-sizing: border-box;
}

.input-group input:focus {
    outline: none;
    border-color: #4299e1;
    box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.15);
}

#errorMessage {
    margin-top: 1rem;
    color: #e53e3e;
    font-size: 0.875rem;
    padding: 0.5rem;
    background-color: #fed7d7;
    border-radius: 0.375rem;
    border: 1px solid #fecaca;
    display: none;
}

#loginForm button {
    padding: 0.75rem 1.5rem;
    background-color: #4299e1;
    color: white;
    border: none;
    border-radius: 0.375rem;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.2s ease, transform 0.2s ease;
    width: 100%;
    margin-top: 0.5rem;
}

#loginForm button:hover {
    background-color: #3182ce;
    transform: translateY(-2px);
}

#greetingDiv {
    padding: 2rem;
    background-color: rgba(255, 255, 255, 0.8);
    border-radius: 10px;
    text-align: center;
    transition: all 0.5s ease;
    width: 100%;
    box-sizing: border-box;
    opacity: 0; /* Tetap 0 secara default */
    transform: translateX(100%); /* Tetap di luar layar default */
}

#greetingDiv h2 {
    margin-bottom: 1rem;
    color: #1a202c;
    font-size: 1.875rem;
    font-weight: 600;
}

#greetingDiv p {
    color: #4a5568;
    font-size: 1rem;
    margin-bottom: 1.5rem;
}

#greetingDiv button {
    padding: 0.75rem 1.5rem;
    background-color: #e53e3e;
    color: white;
    border: none;
    border-radius: 0.375rem;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.2s ease, transform 0.2s ease;
    margin-top: 0.5rem;
}

#greetingDiv button:hover {
    background-color: #c53030;
    transform: translateY(-2px);
}

.dashboard-container {
    padding: 2rem;
    background-color: rgba(255, 255, 255, 0.8);
    border-radius: 10px;
    text-align: left;
    transition: all 0.5s ease;
    width: 100%;
    box-sizing: border-box;
    opacity: 0; /* Tetap 0 secara default */
    transform: translateY(20px); /* Tetap di bawah default */
}

.dashboard-container h2 {
    margin-bottom: 1.5rem;
    color: black;
    font-size: 1.875rem;
    font-weight: 600;
    cursor: pointer; /* Tambahkan cursor pointer agar terlihat bisa diklik */
}

.dashboard-greeting {
    font-size: 1.25rem;
    color: black;
    margin-bottom: 1rem;
    font-weight: 500;
}

.help-section {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid #e2e8f0;
}

.help-section h3 {
    font-size: 1.125rem;
    color: black;
    margin-bottom: 1rem;
    font-weight: 600;
}

.help-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.help-list li {
    display: flex;
    align-items: center;
    margin-bottom: 0.75rem;
    color: black;
}

.help-list li svg {
    margin-right: 0.75rem;
    width: 1.25rem;
    height: 1.25rem;
    color: #4299e1;
}

@media (min-width: 768px) {
    #app {
        max-width: 800px;
        flex-direction: row;
    }

    #loginForm,
    #greetingDiv,
    .dashboard-container {
        width: 50%;
        margin: 0;
    }

    #loginForm {
        border-radius: 10px 0 0 10px;
    }

    #greetingDiv,
    .dashboard-container {
        border-radius: 0 10px 10px 0;
    }
}

.slide-in {
    animation: slideIn 0.5s ease forwards;
}

.slide-out {
    animation: slideOut 0.5s ease forwards;
}

@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateX(100%); /* Untuk greetingDiv */
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

/* Tambahkan keyframes khusus untuk slide-in dashboard dari bawah */
@keyframes slideInDashboard {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.dashboard-container.slide-in { /* Terapkan animasi slideInDashboard ke dashboard */
    animation: slideInDashboard 0.5s ease forwards;
}

.slide-out {
    animation: slideOut 0.5s ease forwards;
}

@keyframes slideOut {
    from {
        opacity: 1;
        transform: translateX(0); /* Untuk greetingDiv */
    }
    to {
        opacity: 0;
        transform: translateX(-100%);
    }
}

.dashboard-container.slide-out { /* Atur animasi slideOut untuk dashboard */
    from {
        opacity: 1;
        transform: translateY(0);
    }
    to {
        opacity: 0;
        transform: translateY(20px);
    }
}

.hidden {
    visibility: hidden;
    opacity: 0;
    position: absolute;
    left: -9999px;
}

/* Note Favorit */
#noteText {
    width: calc(100% - 90px);
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 6px;
    margin-right: 10px;
    box-sizing: border-box; /* Pastikan padding dan border termasuk dalam lebar */
    margin-bottom: 10px; /* Tambahkan margin bawah */
}

#dashboardDiv .section > button { /* Gaya tombol Simpan di bagian Catatan Favorit */
    padding: 10px 15px;
    background: #4CAF50;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    margin-bottom: 15px; /* Tambahkan margin bawah */
}

.note-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    border-bottom: 1px solid #eee;
}

.favorite-icon {
    cursor: pointer;
    font-size: 20px;
    color: #e53e3e; /* Warna ikon hapus */
}

.favorite-icon:hover {
    color: #c53030;
}

/* Kotak Pesan */
#messageBox {
    max-height: 200px;
    overflow-y: auto;
    border: 1px solid #ccc;
    padding: 10px;
    border-radius: 6px;
    margin-top: 10px;
    background: #fafafa;
}

#messageInput {
    width: calc(100% - 70px);
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 6px;
    margin-right: 10px;
    box-sizing: border-box;
    margin-bottom: 10px;
}

#sendMessageBtn {
    padding: 10px 15px;
    background: #2196F3;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
}

/* Pengaturan */
.setting-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

/* Dark Mode */
body.dark-mode {
    background: #1e1e1e;
    color: #f1f1f1;
}

body.dark-mode .section {
    background: #2d2d2d;
    color: #f1f1f1;
    box-shadow: 0 0 8px rgba(255,255,255,0.1);
}

body.dark-mode .note-item,
body.dark-mode #messageBox {
    background: #3a3a3a;
    border-color: #555;
}

body.dark-mode #noteText,
body.dark-mode #messageInput {
    background: #444;
    color: #f1f1f1;
    border-color: #555;
}

body.dark-mode #noteText::placeholder,
body.dark-mode #messageInput::placeholder {
    color: #ccc;
}

.section {
    background: white;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 0 8px rgba(0,0,0,0.1);
}

ul {
    list-style-type: none;
    padding-left: 0;
}

li {
    padding: 10px 0;
    border-bottom: 1px solid #e2e8f0;
}

li:last-child {
    border-bottom: none;
}

.icon {
    margin-right: 10px;
    font-size: 18px;
    color: #6b7280;
}

/* Gaya Pop-up Catatan Favorit */
#topicNotesContainer {
    margin-top: 15px;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 6px;
    background-color: #f9f9f9;
}

#topicNotesContainer ul {
    padding-left: 20px;
}

#topicNotesContainer li {
    padding: 5px 0;
    border-bottom: 1px dotted #eee;
}

#topicNotesContainer li:last-child {
    border-bottom: none;
}

/* Gaya Tombol di Pop-up */
#app > div > div[style*="position: fixed"] button {
    padding: 8px 12px;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin-right: 5px;
    transition: background-color 0.2s ease;
}

#app > div > div[style*="position: fixed"] button:hover {
    background-color: #0056b3;
}

#app > div > div[style*="position: fixed"] h3 {
    margin-bottom: 15px;
    color: #333;
}


.saved-notes-modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5); /* Semi transparan background */
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.saved-notes-modal-content {
  background-color: white;
  width: 90%;
  max-width: 600px;
  max-height: 90vh; /* Hindari overflow layar */
  overflow: hidden; /* Jangan biarkan seluruh modal scroll */
  border-radius: 8px;
  padding: 20px;
  position: relative;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
  display: flex;
  flex-direction: column;
}

#savedNotesContainer {
  flex: 1;
  overflow-y: auto;
  margin-top: 10px;
  max-height: 60vh; /* Bagian inilah yang scroll, bukan modalnya */
  padding-right: 8px;
}





















.modal-close-button {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
}

.modal-close-button:hover,
.modal-close-button:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
}


.save-individual-note.saved {
¬† ¬† background-color: #3b82f6;
¬† ¬† color: white;
¬† ¬† font-weight: bold;
}

.saved-note-card {
  background: white;
  max-width: 640px;
  margin: 0 auto 20px;
  border-radius: 14px;
  padding: 20px 24px; /* Kurangi padding kiri karena ::before dihilangkan */
  display: flex;
  align-items: center;
  position: relative;
  box-shadow: 0 6px 16px rgba(0,0,0,0.04);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.saved-note-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 24px rgba(0,0,0,0.06);
}

.saved-note-card::before {
  content: none; /* Hilangkan garis vertikal */
}

.saved-note-card .note-body {
  display: flex;
  align-items: center; /* Pastikan elemen di dalamnya juga center */
  width: 100%; /* Ambil seluruh lebar yang tersedia */
}

.saved-note-card .note-text {
  flex-grow: 1; /* Biarkan teks mengambil ruang sebanyak mungkin */
  margin-right: 15px; /* Beri jarak dengan elemen aksi */
}

.saved-note-card .note-actions {
  /* Gaya untuk tombol dan ikon aksi */
}

.saved-note-card .badge {
  /* Gaya untuk badge */
  margin-left: 15px; /* Beri jarak dengan elemen aksi atau teks */
}

 
 .info-bar-container {
            background-color: transparent;
            color: black;
            padding: 20px;
            text-align: center;
            width: 100%;
            box-sizing: border-box;
            border-bottom: 1px solid #4a5d73;
            font-size: 1.1em;
            position: absolute;
            top: 0;
            left: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            overflow: hidden;
            cursor: pointer;
        }

        .info-bar-container:hover {
            background-color: transparent;
        }

        .icon-text-group {
            display: flex;
            align-items: center;
            white-space: nowrap;
			colour: black;
        }

        .info-icon {
            font-size: 1.5em;
            margin-right: 8px;
            display: inline-block;
        }

        .announcement-icon {
            color: #ffc107;
            animation: shake 0.82s cubic-bezier(.36,.07,.19,.97) both infinite;
            transform: translate3d(0, 0, 0);
            backface-visibility: hidden;
            perspective: 1000px;
        }

        .birthday-icon {
            color: #28a745;
            animation: bounce 2s infinite;
        }

        .countdown-icon {
            color: #dc3545;
        }

        .countdown-text {
            font-weight: bold;
            color: black;
        }

        @keyframes shake {
            10%, 90% {
                transform: translate3d(-1px, 0, 0);
            }
            20%, 80% {
                transform: translate3d(2px, 0, 0);
            }
            30%, 50%, 70% {
                transform: translate3d(-4px, 0, 0);
            }
            40%, 60% {
                transform: translate3d(4px, 0, 0);
            }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }

        @media (max-width: 768px) {
            .info-bar-container {
                flex-direction: column;
                gap: 10px;
            }
        }

        .perjalanan-hidup-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        .perjalanan-hidup-modal.perjalanan-hidup-modal-show {
            display: flex;
            opacity: 1;
        }

        .perjalanan-hidup-modal-content {
            background-color: #ffffff;
            color: #333;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
            position: relative;
            width: 90%;
            max-width: 800px;
            transform: translateY(-50px);
            transition: transform 0.3s ease-in-out;
            overflow-y: auto; /* Tambahkan scrollbar jika konten melampaui tinggi maksimal */
            max-height: 90vh; /* Tinggi maksimal modal content */
        }

        .perjalanan-hidup-modal.perjalanan-hidup-modal-show .perjalanan-hidup-modal-content {
            transform: translateY(0);
        }

        .perjalanan-hidup-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ddd;
        }

        .perjalanan-hidup-modal-header h2 {
            margin: 0;
            font-size: 1.5em;
            font-weight: bold;
        }

        .perjalanan-hidup-close-button {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 2em;
            color: #aaa;
            cursor: pointer;
            border: none;
            background: none;
            padding: 0;
            line-height: 1;
            opacity: 0.7;
            transition: opacity 0.2s ease;
        }

        .perjalanan-hidup-close-button:hover {
            color: #555;
            opacity: 1;
        }

        .perjalanan-hidup-timeline {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .perjalanan-hidup-timeline li {
            margin-bottom: 15px;
            position: relative;
            padding-left: 40px;
        }

        .timeline-icon {
            position: absolute;
            left: 0;
            top: 5px;
            font-size: 1.2em;
            color: #007bff;
        }

        .timeline-date {
            font-size: 0.9em;
            color: #888;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .timeline-title {
            font-size: 1.1em;
            font-weight: bold;
            margin-bottom: 5px;
            display: inline-block;
            padding: 5px 0;
        }

        .timeline-content {
            font-size: 1em;
            line-height: 1.5;
            color: #555;
        }

        .timeline-content img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin-top: 10px;
            display: block;
        }

        .timeline-link {
            display: inline-block;
            margin-top: 10px;
            color: #007bff;
            text-decoration: none;
            font-weight: bold;
        }

        .timeline-link:hover {
            text-decoration: underline;
        }

        .timeline li:before {
            content: '';
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            border-left: 2px solid #007bff;
            margin-top: 10px;
        }

        .number-title {
            font-weight: bold;
            margin-right: 5px;
            color: #007bff;
        }

        .highlight-block {
            background-color: #7FFF00;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            border: 1px solid #b2ebf2;
        }

        @media (max-width: 768px) {
            .perjalanan-hidup-modal-content {
                width: 95%;
                max-width: 95%;
                margin: 20px auto;
            }
            .perjalanan-hidup-timeline li {
                padding-left: 30px;
            }
            .perjalanan-hidup-timeline li:before {
                left: 10px;
            }
             .info-bar-container {
                flex-direction: column;
                gap: 10px;
            }
        }

        .perjalanan-hidup-modal-content {
          animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }
 
 
 .message-container {
        display: flex;
        margin-bottom: 10px;
        align-items: flex-end;
    }
    .message-bubble {
        padding: 10px 15px;
        border-radius: 18px;
        max-width: 70%;
        position: relative;
        word-wrap: break-word;
    }
    .message-bubble::before {
        content: '';
        position: absolute;
        bottom: 0;
        width: 0;
        height: 0;
        border: 10px solid transparent;
    }

    /* Styles for sender's messages */
    .sent .message-bubble {
        background-color: #dcf8c6; /* Light green for sender */
        color: #333;
        margin-left: auto; /* Push to the right */
        border-bottom-right-radius: 2px; /* Sharpen corner for sender */
    }
    .sent .message-bubble::before {
        left: auto;
        right: -7px;
        border-left-color: #dcf8c6;
        border-bottom-color: #dcf8c6;
    }
    .sent .message-container {
        justify-content: flex-end; /* Align messages to the right */
    }


    /* Styles for receiver's messages */
    .received .message-bubble {
        background-color: #e0e0e0; /* Light grey for receiver */
        color: #333;
        border-bottom-left-radius: 2px; /* Sharpen corner for receiver */
    }
    .received .message-bubble::before {
        left: -7px;
        border-right-color: #e0e0e0;
        border-bottom-color: #e0e0e0;
    }
    .received .message-container {
        justify-content: flex-start; /* Align messages to the left */
    }

    .message-info {
        font-size: 0.75em;
        color: #777;
        margin-top: 5px;
        text-align: right; /* Default for sender */
    }
    .received .message-info {
        text-align: left; /* Adjust for receiver */
    }

    .message-sender {
        font-weight: bold;
        margin-bottom: 2px;
        font-size: 0.85em;
    }
    .profile-pic {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        background-color: #66bb6a; /* Default color, could be dynamic */
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.8em;
        font-weight: bold;
        margin: 0 8px;
        flex-shrink: 0; /* Prevent shrinking */
    }
    .received .profile-pic {
        order: -1; /* Place profile pic before message bubble for receiver */
    }
 
 
 
 
 
 
 
 
 
 
    </style>
</head>
<body>

 <div class="info-bar-container" id="infoBar">
        <div class="icon-text-group">
            <span class="info-icon announcement-icon">üì¢</span>
            <span>Pengumuman:</span>
        </div>
        <div class="icon-text-group">
            <span class="info-icon birthday-icon">üéâ</span>
            <span>Selamat Ulang Tahun Farid Ardiansyah!</span>
        </div>
        <div class="icon-text-group">
            <span class="info-icon countdown-icon">‚è≥</span>
            <span class="countdown-text" id="countdown"></span>
        </div>
    </div>
	
	


    <div class="perjalanan-hidup-modal" id="myModal">
        <div class="perjalanan-hidup-modal-content">
            <div class="perjalanan-hidup-modal-header">
                <h2>Perjalanan Hidup</h2>
                <button class="perjalanan-hidup-close-button" id="closeModalBtn">&times;</button>
            </div>
            <ul class="perjalanan-hidup-timeline">
                <li>
                    <div class="timeline-icon">üë∂</div>
                    <div class="timeline-date"><span class="hari">Selasa </span>, 29 Mei 2001 <span class="pukul">xx:xx WIB</span></div>
                    <h3 class="timeline-title"><span class="number-title">1.</span> Kelahiran</h3>
                    <div class="timeline-content">
                        <p>Farid Ardiansyah lahir di Jakarta Utara, Jakarta.  Anak pertama dari pasangan [Nama Ayah] dan [Nama Ibu].</p>
                        <img src="images/2001.jpg" alt="Foto Kelahiran Farid" width="400" height="300">
                    </div>
                </li>
				
                <li>
                    <div class="timeline-date"><span class="hari">x</span>, xx x 2013 <span class="pukul">xx:xx WIB</span></div>
                    <h3 class="timeline-title"><span class="number-title">2.</span> Lulus MI</h3>
                    <div class="timeline-content">
                        <p>Meraih lulus dari sekolah MI, melanjutkan ke MTSN 2013.</p>
						 <img src="images/5.jpg" alt="" width="400" height="300">
                        <div class="highlight-block">
                            <p>"Menurut saya, lulus dari sekolah Mi dengan NEM baik, buat melanjutkan masuk sekolah MTSN."</p>
                        </div>
						</div>
                </li>
				<li>
                    <div class="timeline-date"><span class="hari">x</span>, xx x 2016 <span class="pukul">xx:xx WIB</span></div>
                    <h3 class="timeline-title"><span class="number-title">3.</span> Lulus MTSN</h3>
                    <div class="timeline-content">
                        <p>Meraih lulus dari sekolah MTSN, melanjutkan ke SMKN 2016.</p>
						                       <img src="images/5.jpg" alt="" width="400" height="300">
                        <div class="highlight-block">
                            <p>"Menurut saya, lulus dari sekolah MTSN dengan Test masuk baik, buat melanjutkan masuk sekolah SMKN."</p>
                        </div>
						 </div>
						 </li>
                 
				<li>
                      <div class="timeline-date"><span class="hari">x</span>, xx x 2019 <span class="pukul">xx:xx WIB</span></div>
                    <h3 class="timeline-title"><span class="number-title">4.</span> Lulus SMKN</h3>
                    <div class="timeline-content">
                        <p>Meraih lulus dari sekolah SMKN, melanjutkan ke Universitas Gunadarma 2019.</p>
						                       <img src="images/5.jpg" alt="" width="400" height="300">
                        <div class="highlight-block">
                            <p>"Menurut saya, lulus dari sekolah SMKN, lumayan sulit banyak kegiatan seperti PKL, USBN, UN, US, UPRAK, dst. dengan Test masuk baik sampai 1000 soal pg lebih, buat melanjutkan masuk kuliah Universitas Gunadarma 2019."</p>
                        </div>
						</div>
                </li>
				<li>
                    
					
					
					Coming Soon
					
					
					
					
					
                </li>
				
				
                <li>
                    <div class="timeline-icon">üíº</div>
                    <div class="timeline-date"><span class="hari">Coming Soon</span>, Coming Soon <span class="pukul">Coming Soon WIB</span></div>
                    <h3 class="timeline-title"><span class="number-title">5.</span> Karier Pertama Coming Soon</h3>
                    <div class="timeline-content">
                        <p>Coming Soon.</p>
						 <img src="images/5.jpg" alt="" width="400" height="300">
                        <p>Kunjungi <a href="https://www.example.com" target="_blank" rel="noopener noreferrer" class="timeline-link">website perusahaan</a> untuk informasi lebih lanjut.</p>
                    </div>
                </li>
				
				
                 <li>
                    <div class="timeline-icon">üöÄ</div>
                    <div class="timeline-date"><span class="hari">Coming Soon</span>, Coming Soon <span class="pukul">Coming Soon WIB</span></div>
                    <h3 class="timeline-title"><span class="number-title">6.</span> Pencapaian Coming Soon</h3>
                    <div class="timeline-content">
                        <p>Coming Soon.</p>
						 <img src="images/5.jpg" alt="" width="400" height="300">
                    </div>
                </li>
				
				 <li>
                    <div class="timeline-icon">üöÄ</div>
                    <div class="timeline-date"><span class="hari">Coming Soon</span>, Coming Soon Umur 30 an <span class="pukul">Coming Soon WIB</span></div>
                    <h3 class="timeline-title"><span class="number-title">7.</span> Istri Pertama Coming Soon</h3>
                    <div class="timeline-content">
                        <p>Coming Soon.</p>
						 <img src="images/5.jpg" alt="" width="400" height="300">
                    </div>
                </li>
				
				 <li>
                    <div class="timeline-icon">üöÄ</div>
                    <div class="timeline-date"><span class="hari">Coming Soon</span>, Coming Soon <span class="pukul">Coming Soon WIB</span></div>
                    <h3 class="timeline-title"><span class="number-title">8.</span> Anak Pertama Coming Soon</h3>
                    <div class="timeline-content">
                        <p>Coming Soon.</p>
						 <img src="images/5.jpg" alt="" width="400" height="300">
                    </div>
                </li>
				
                <li>
                    <div class="timeline-icon">üåç</div>
                    <div class="timeline-date"><span class="hari">Coming Soon</span>, Coming Soon<span class="pukul">Coming Soon WIB</span></div>
                    <h3 class="timeline-title"><span class="number-title">9.</span> Kontribusi volunteer Coming Soon</h3>
                    <div class="timeline-content">
                        <p>Menjadi kontributor aktif dalam proyek open source <a href="https://github.com/example/open-source-project" target="_blank" rel="noopener noreferrer" class="timeline-link">Coming Soon</a>. Coming Soon.</p>
						 <img src="images/5.jpg" alt="" width="400" height="300">
                    </div>
                </li>
            </ul>
        </div>
    </div>



    <h1>üìù Noted</h1>


    <div class="note-input-container">
    <input type="text" id="noteInput" placeholder="Tulis catatan di sini...">
    <button id="saveBtn">Simpan</button>
    <button id="voiceInputBtn" class="voice-icon-btn" title="Mulai/Berhenti Rekaman Suara">
        <svg viewBox="0 0 24 24" fill="currentColor">
            <path fill="none" d="M0 0h24v24H0z"/>
            <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"/>
        </svg>
    </button>

    <canvas id="waveformCanvas" width="300" height="80"></canvas>
    <div id="voicePlaybackContainer"></div>

    <input type="text" id="noteInput" placeholder="Catatan suara Anda akan muncul di sini..." readonly>

    <div id="notesList" class="note-display">
        <p>Tekan ikon mikrofon untuk memulai catatan suara.</p>
    </div>
</div>

 
   <div id="app">
    <div class="login-container slide-in" id="loginForm">
        <h2>Login</h2>
        <div class="input-group">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required>
        </div>
        <div class="input-group">
            <label for="password">Password:</label>
            <input type="password" id="password" name="password" required>
        </div>

        <button id="emailLoginBtn" class="primary-button">Login</button>
        <p id="errorMessage" class="error-message hidden"></p>
    </div>

    <div class="greeting-container hidden" id="greetingDiv">
        <h2 id="userGreeting">Halo Pengguna üëã</h2>
        <button onclick="logoutFirebase()">Keluar</button>
    </div>
</div>
        
    <div class="dashboard-container hidden" id="dashboardDiv">
        <h2>Dashboard Akun</h2>
        <p class="dashboard-greeting" id="dashboardGreetingName">Halo, Penggunaüëã</p>
        <div class="section">
            <h2>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor">
                    <path d="M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2z"/>
                </svg>
                Catatan Favorit
            </h2>
            <div style="margin-bottom: 10px;">
                <button id="showSavedNotesBtn" class="bulk-save-button">Lihat Catatan Tersimpan</button>
            </div>
            <div id="notesList"></div>
        </div>
    </div>

    <div id="savedNotesModal" class="saved-notes-modal-overlay" style="display: none;">
    <div class="saved-notes-modal-content">
        <button class="modal-close-button" id="closeSavedNotesModal">&times;</button>
        <h2>Catatan yang Anda Simpan</h2>
        <label for="topicFilter">Filter Berdasarkan Topik:</label>
        <select id="topicFilter">
            <option value="">Semua Topik</option>
            <option value="makanan">Makanan</option>
            <option value="belajar">Belajar</option>
            <option value="pekerjaan">Pekerjaan</option>
            <option value="hiburan">Hiburan</option>
            <option value="kesehatan">Kesehatan</option>
            <option value="cinta">Cinta</option>
            <option value="lain-lain">Lain-lain</option>
        </select>
        <div id="savedNotesContainer">
        </div>
</div>
</div>

       <div class="section">
    <h2>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor">
            <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V8l8 5 8-5v10zm-8-5l-8-5H4l8 5 8-5h-8z"/>
        </svg>
        Pesan
    </h2>
    <div id="messageBox" style="height: 300px; overflow-y: scroll; border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; border-radius: 8px; background-color: #f9f9f9;"></div>
    <input type="text" id="messageInput" placeholder="Ketik pesan..." style="width: calc(100% - 70px); padding: 10px; border: 1px solid #ddd; border-radius: 5px; margin-right: 5px;" />
    <button onclick="sendMessage()" style="padding: 10px 15px; background-color: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer;">Kirim</button>
</div>

        <div class="section">
            <h2>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-1.41 1.41C12.99 13.46 12 14 12 16h-2v-.5c0-1.99 1.51-3.49 3.57-3.49 1.41 0 2.54.83 3.02 2.08l1.41-1.41C16.81 10.24 14.49 9 12 9c-1.86 0-3.47 1.27-3.9 3.01L6.23 13.16c.47 1.74 2.14 3.09 3.9 3.09 2.31 0 4.2-1.71 4.2-4.09 0-1.53-.88-2.89-2.13-3.59z"/>
                </svg>
                Bantuan
            </h2>
            <ul>
                <li>
                    <a href="#" onclick="showHelp('faq')">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-1.41 1.41C12.99 13.46 12 14 12 16h-2v-.5c0-1.99 1.51-3.49 3.57-3.49 1.41 0 2.54.83 3.02 2.08l1.41-1.41C16.81 10.24 14.49 9 12 9c-1.86 0-3.47 1.27-3.9 3.01L6.23 13.16c.47 1.74 2.14 3.09 3.9 3.09 2.31 0 4.2-1.71 4.2-4.09 0-1.53-.88-2.89-2.13-3.59z"/>
                        </svg>
                        FAQ
                    </a>
                </li>
                <li>
                    <a href="#" onclick="showHelp('guide')">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor">
                            <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14h-2v-2h2v2zm2-4h-4V6h4v6z"/>
                        </svg>
                        Panduan
                    </a>
                </li>
                <li>
                    <a href="#" onclick="showHelp('contact')">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor">
                            <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 9h-2V5h2v6zm0 4h-2v-2h2v2z"/>
                        </svg>
                        Kontak
                    </a>
                </li>
            </ul>
            <div id="helpContent"></div>
        </div>

        <div class="section">
            <h2>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor">
                    <path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.81c.19-.17.2-.5.03-.69l-2.8-4.83c-.17-.3-.5-.32-.7-.15l-2.42 2.08c-.51-.26-1.03-.48-1.58-.65l-.31-2.59c-.03-.34-.32-.6-.67-.6h-3.3c-.35 0-.64.26-.67.6l-.31 2.59c-.55.17-1.07.39-1.58.65L6.46 4.66c-.2-.17-.53-.15-.7.15l-2.8 4.83c-.17.19-.18.5-.03.69l2.11 1.81c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.81c-.19.17-.2.5-.03.69l2.8 4.83c.17.3.5.32.7.15l2.42-2.08c.51.26 1.03.48 1.58.65l.31 2.59c.03.34.32.6.67.6h3.3c.35 0 .64-.26.67-.6l.31-2.59c.55-.17 1.07-.39 1.58-.65l2.42 2.08c.2.17.53.15.7-.15l2.8-4.83c.17-.19.18-.5.03-.69l-2.11-1.81zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"/>
                </svg>
                Pengaturan
            </h2>
            <label><input type="checkbox" onchange="toggleDarkMode()" /> Mode Gelap</label><br>
            <label><input type="checkbox" onchange="toggleNotifications()" /> Notifikasi</label>
        </div>

        <div class="section">
            <h2>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor">
                    <path d="M16 11c1.66 0 2.99-1.34 2.99-3S19.66 5 18 5c-1.66 0-2.99 1.34-2.99 3S16.34 11 18 11zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-3.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62-.06-.94-.16 1.64-1.03 2.89-2.79 2.89-4.69 0-1.9-1.25-3.66-2.89-4.69.32-.1.65-.16.94-.16 2.33 0 7 1.17 7 3.5V19h-14v-3.5c0-2.33 4.67-3.5 7-3.5z"/>
                </svg>
                Komunitas
            </h2>
            <ul>
                <li>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor">
                        <path d="M20.5 2H3.5c-.83 0-1.5.67-1.5 1.5S2.67 5 3.5 5h17c.83 0 1.5-.67 1.5-1.5S21.33 2 20.5 2zm0 4H3.5c-.83 0-1.5.67-1.5 1.5S2.67 9 3.5 9h17c.83 0 1.5-.67 1.5-1.5S21.33 6 20.5 6zm0 4H3.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5h17c.83 0 1.5-.67 1.5-1.5s-.67-1.5-1.5-1.5zM3.5 16h17c.83 0 1.5-.67 1.5-1.5S21.33 13 20.5 13H3.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5z"/>
                    </svg>
                 Komunitas
                </li>
                <li>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor">
                        <path d="M20 2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 18H4V4h16v16zM6 14h4v-4H6v4zm8 0h4v-4h-4v4z"/>
                    </svg>
                    Blog
                </li>
            </ul>
        </div>

        <div class="section">
            <h2>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM10 10v4h4v-4h-4zm2-4c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>
                </svg>
                Tentang Kami
            </h2>
            <ul>
                <li>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM10 10v4h4v-4h-4zm2-4c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>
                    </svg>
                    Tentang Note Farid
                </li>
                <li>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/>
                    </svg>
                    Identitas Brand
                </li>
                <li>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor">
                        <path d="M20 15.5c-1.66 0-3.17-.67-4.22-1.78L12 12.5 7.78 13.72C6.73 14.83 5.22 15.5 3.5 15.5V5c0-1.1.9-2 2-2h15c1.1 0 2 .9 2 2v10.5c-1.72 0-3.23-.67-4.28-1.78L16 12.5l4.22-1.22C20.27 10.67 21.78 10 23.5 10V15.5c-1.72 0-3.23.67-4.28 1.78L16 17.5l-4.22-1.22C10.73 15.67 9.22 15 7.5 15V5h1v10.5c1.66 0 3.17.67 4.22 1.78L12 12.5l4.22 1.22C17.27 11.67 18.78 11 20.5 11V5h1v10.5c1.72 0 3.23.67 4.28 1.78L16 17.5l-4.22 1.22C10.73 15.67 9.22 15 7.5 15V15.5z"/>
                    </svg>
                    Hubungi Kami
                </li>
                <li>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor">
                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14h-2v-2h2v2zm2-4h-4V6h4v6z"/>
                    </svg>
                    Aturan Penggunaan
                </li>
                <li>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor">
                        <path d="M12 4a4 4 0 0 1 4 4 4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4z"/>
                    </svg>
                    Karir
                </li>
            </ul>
        </div>
<button onclick="logoutFirebase()" style="margin-top: 1rem;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor">
                <path d="M10.09 15.59L11.5 17l5-5-5-5-1.41 1.41L10.09 13H3v2h7.09zM21 3h-6v2h4v16h-4v2h6c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"/>
            </svg>
            Keluar
        </button>
    </div>
</div>
   
   
  
   
	
	
<div id="notificationIcon" style="position: relative; margin-left: 15px; cursor: pointer;">
    üîî
    <span id="notificationCount" style="...">0</span>
</div>

<div id="notificationPopup" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); display: none; z-index: 1000;">
    <div style="background-color: white; width: 90%; max-width: 500px; border-radius: 8px; margin: 50px auto; box-shadow: 0 2px 10px rgba(0,0,0,0.1); position: relative;">
        <div style="padding: 10px; border-bottom: 1px solid #eee; font-weight: bold; display: flex; justify-content: space-between; align-items: center;">
            <span style="font-size: 1.2em;">Info Pengumuman</span>
            <button id="closeNotificationPopup" style="border: none; background: none; font-size: 1.5em; cursor: pointer; color: #888;">&times;</button>
        </div>
        <ul id="notificationListItems" style="list-style: none; padding: 0; margin: 0;">
            <li style="padding: 15px; border-bottom: 1px solid #eee;">Tidak ada notifikasi baru</li>
        </ul>
        <div id="notificationFullContent" style="padding: 15px; display: none; border-top: 1px solid #eee;">
            </div>
        <div style="padding: 10px; text-align: center;">
            <button id="markAllRead" style="...">Tandai Semua Sudah Dibaca</button>
        </div>
    </div>
</div>



    <div class="topic-filter">
        <button class="topic-button active" data-topic="semua">Semua</button>
    </div>

    <div id="noteList"></div>
    <div id="popup" class="popup">Catatan berhasil disimpan!</div>
	
	<div class="activity-filter" style="margin-bottom: 10px; text-align: right;">
    <label for="activityYear" style="font-size: 12px; margin-right: 5px;">Tahun:</label>
    <select id="activityYear" style="padding: 5px; border-radius: 5px; border: 1px solid #ccc; font-size: 12px;">
        </select>
</div>

<div class="activity-table-container">
    </div>


 
    
	
	
<div id="guidePopup" class="guide-popup">
¬† ¬† ¬† ¬† <h3>Panduan Topik</h3>
¬† ¬† ¬† ¬† <div id="guideContent">
¬† ¬† ¬† ¬† ¬† ¬† <p id="guideText"></p>
¬† ¬† ¬† ¬† ¬† ¬† <p><a id="learnMoreLink" href="#" target="_blank">Pelajari Lebih Lanjut</a></p>
¬† ¬† ¬† ¬† </div>
¬† ¬† ¬† ¬† <button id="closeGuideBtn">Tutup</button>
¬† ¬† </div>
	

    <div id="overlay" class="overlay"></div>
	<div class="modal-overlay" id="termsModal">
  <div class="modal-content">
    <button class="close-btn" id="closeTermsModal">&times;</button>
    <div style="background-color: #E0F7FA; padding: 15px; border-radius: 8px; margin-bottom: 10px; text-align: left;">
      <div style="display: flex; align-items: center; margin-bottom: 5px;">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px; height: 20px; margin-right: 8px;"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline></svg>
        <h2 style="font-size: 1.2em; margin: 0;">Ketentuan</h2>
      </div>
      <ol style="padding-left: 20px; margin-top: 5px;">
        <li>Pengguna diharapkan menggunakan platform ini, untuk tujuan catatan yang positif dan efektif..</li>
        <li style="background-color: #FFF9C4; padding: 10px; border-radius: 6px; margin-top: 8px; list-style: none;">2. Pengembang bertanggung jawab atas kesalahan pribadi pengguna yg disengaja/ga sengaja</li>
        <li style="background-color: #FFD54F; padding: 10px; border-radius: 6px; margin-top: 8px; list-style: none;">3. ...</li>
        <li style="background-color: #FFAB91; padding: 10px; border-radius: 6px; margin-top: 8px; list-style: none;">4. ...</li>
      </ol>
    </div>
    <div style="background-color: #FCE4EC; padding: 10px; border-radius: 6px; margin-bottom: 10px; text-align: left; font-size: 0.9em;">
      <span style="color: #E91E63;">: Halaman Ketentuan</span>
    </div>
    <div style="display: flex; align-items: center; font-size: 0.8em; color: #757575;">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 16px; height: 16px; margin-right: 5px;"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
      <span>Terakhir diperbarui: 28 April 2025 Jam 21.30</span>
    </div>
  </div>
</div>

<div class="info-popup" id="info-popup">
    <div class="info-popup-content" id="info-popup-text">
        <button class="info-close-btn" onclick="closeInfoPopup()">√ó</button>
        </div>
</div>
<div class="info-card info-ketentuan" data-type="ketentuan">
    <div class="info-icon">üìú</div>
    <h3>Ketentuan</h3>
    <svg class="info-arrow-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path d="M14 3h7v7h-2V6.41l-9.29 9.3-1.42-1.42L17.59 5H14V3z"/>
    </svg>
</div>
<div class="info-card info-tentang" data-type="tentang">
    <div class="info-icon">‚ÑπÔ∏è</div>
    <h3>Tentang Kami</h3>
    <svg class="info-arrow-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path d="M14 3h7v7h-2V6.41l-9.29 9.3-1.42-1.42L17.59 5H14V3z"/>
    </svg>
</div>
<div class="info-card info-privasi" data-type="privasi">
    <div class="info-icon">üîí</div>
    <h3>Kebijakan Privasi</h3>
    <svg class="info-arrow-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path d="M14 3h7v7h-2V6.41l-9.29 9.3-1.42-1.42L17.59 5H14V3z"/>
    </svg>
</div>


  <div class="user-card admin-border">
  <strong>Farid Ardiansyah</strong>
  <span class="badge admin">Admin</span>
</div>

<div class="user-card kontributor-border">
  <strong>Farid Ardiansyah</strong>
  <span class="badge kontributor">Kontributor</span>
</div>

<div class="user-card member-border">
  <strong>Farid Ardiansyah</strong>
  <span class="badge member">Member</span>
</div>

<!-- Popup untuk Role -->
<div id="role-popup-overlay" class="role-popup-overlay">
  <div class="role-popup-box">
    <span id="role-popup-badge" class="badge"></span>
    <p id="role-popup-desc"></p>
    <button class="close-btn">Tutup</button>
  </div>
</div>

<div id="activity-popup-overlay" class="role-popup-overlay">
    <div class="role-popup-box">
        <h3 id="activity-popup-title"></h3>
        <p id="activity-popup-details"></p>
        <button class="close-btn" id="close-activity-popup">Tutup</button>
    </div>
</div>


<div id="cookieExplanation" class="modal-overlay" style="display: none;">
    <div class="modal-content">
        <button class="close-btn" id="closeCookieExplanation">&times;</button>
		
		<li style="background-color: #7FFF00; padding: 10px; border-radius: 8px; margin-bottom: 8px;">
                <strong>Penjelasan Cookies website note farid.
            </li>
		
        <h3>Penjelasan Lebih Lanjut tentang Cookie</h3>
        <p>Cookie adalah file teks kecil yang ditempatkan di perangkat Anda untuk membantu situs web mengingat informasi tentang kunjungan Anda. Kami menggunakan cookie untuk:</p>
        <ul style="padding-left: 0; list-style: none;">
            <li style="background-color: #e0f7fa; padding: 10px; border-radius: 8px; margin-bottom: 8px;">
                <strong>1.</strong> Mengingat preferensi Anda (misalnya, bahasa, tema).
            </li>
            <li style="background-color: #fff9c4; padding: 10px; border-radius: 8px; margin-bottom: 8px;">
                <strong>2.</strong> Menganalisis bagaimana Anda menggunakan situs kami untuk meningkatkan pengalaman.
            </li>
            <li style="background-color: #ffcdd2; padding: 10px; border-radius: 8px; margin-bottom: 8px;">
                <strong>3.</strong> Mendukung fungsionalitas penting situs.
            </li>
			<li style="background-color: yellow; padding: 10px; border-radius: 8px; margin-bottom: 8px;">
                <strong>4.</strong> Dengan menyetujui, Anda mengizinkan kami menggunakan cookie sesuai dengan kebijakan kami.
            </li>
        </ul>
        <button id="acceptFromExplanation" style="background-color: #007bff; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;">Terima dan Tutup</button>
    </div>
</div>

<div class="activity-calendar"></div>


 <h2 class="text-center mt-10 mb-5 text-2xl font-semibold text-gray-800 margin-top: 30px;">
  Artikel Blog
</h2>
<div id="blogList" class="container mx-auto">
</div>
<div id="blogContentArea" class="container mx-auto bg-white rounded-lg shadow-md p-6">
  <h3 id="blogContentTitle" class="text-xl font-semibold text-gray-800 mb-4"></h3>
  <div id="blogContent" class="text-lg text-gray-700">
  </div>
  <button id="closeBlogContent" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded mt-4">Tutup Artikel</button>
</div>

<nav id="pagination" class="pagination">
  <ul class="pagination-list">
  </ul>
  <a href="#" class="pagination-next-link" onclick="nextPage()">Next Page</a>
</nav>


    <div id="filter-button-container">
        <button id="showQuoraTitles">Tampilkan Judul Quora</button>
    </div>

    <div id="blogList">
        </div>

    <div id="quoraPopup" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: white; padding: 20px; border: 1px solid #ccc; box-shadow: 0 4px 8px rgba(0,0,0,0.2); z-index: 10;">
        <h2>Judul dari Sumber: Quora</h2>
        <ul id="quoraTitleList">
            </ul>
        <button id="closeQuoraPopup">Tutup</button>
    </div>

<div class="blog-tags-container" style="display: flex; gap: 10px; margin-bottom: 20px;">
    <span class="blog-tag" data-tag="Elon Musk" style="background-color: green; color: white; padding: 5px 10px; border-radius: 15px; cursor: pointer;"></span>
    <span class="blog-tag" data-tag="Kolonisasi Mars" style="background-color: red; color: white; padding: 5px 10px; border-radius: 15px; cursor: pointer;"></span>
    <span class="blog-tag" data-tag="Planet Mars" style="background-color: yellow; padding: 5px 10px; border-radius: 15px; cursor: pointer; color: black;"></span>
    </div>

<div id="tagFilterPopup" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: white; padding: 20px; border: 1px solid #ccc; box-shadow: 0 4px 8px rgba(0,0,0,0.2); z-index: 10; width: 80%; max-width: 500px;">
    <h2 id="tagFilterTitle">Artikel dengan Tag:</h2>
    <ul id="tagArticleList" style="list-style: none; padding: 0;">
        </ul>
    <button id="closeTagFilter" style="margin-top: 15px; padding: 8px 15px; background-color: #dc3545; color: white; border: none; border-radius: 5px; cursor: pointer;">Tutup</button>
</div>




   

 







  
<script type="module">
¬† ¬† import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js";
    import { getFirestore, collection, addDoc, onSnapshot, serverTimestamp, query, orderBy, getDoc, setDoc, doc, updateDoc, where, getDocs, documentId } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-firestore.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword , signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-auth.js"; // Pastikan semua fungsi auth yang Anda butuhkan diimpor


    const firebaseConfig = {
        apiKey: "AIzaSyCYbxo8n1zn-Y3heCIn_PmrsK44_OrdEw4",
        authDomain: "noted-farid.netlify.app",
        projectId: "noted-a3498",
        storageBucket: "noted-a3498.appspot.com",
        messagingSenderId: "1077214793842",
        appId: "1:1077214793842:web:a70cc3643eceb53e3932eb",
        measurementId: "G-SENDQS5Y7K"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app); // Gunakan getAuth() untuk mendapatkan instance auth

¬† ¬† ¬† ¬† const notesRef = collection(db, "notes");
const activityRef = collection(db, "activities");


¬† ¬† ¬† ¬† const noteInput = document.getElementById("noteInput");
¬† ¬† ¬† ¬† const noteList = document.getElementById("noteList");
¬† ¬† ¬† ¬† const popup = document.getElementById("popup");
¬† ¬† ¬† ¬† const saveBtn = document.getElementById("saveBtn");
¬† ¬† ¬† ¬† const topicFilter = document.querySelector(".topic-filter");
¬† ¬† ¬† ¬† const guidePopup = document.getElementById("guidePopup");
¬† ¬† ¬† ¬† const guideText = document.getElementById("guideText");
¬† ¬† ¬† ¬† const guideLink = document.getElementById("guideLink");
¬† ¬† ¬† ¬† const closeGuideBtn = document.getElementById("closeGuideBtn");
const voiceInputBtn = document.getElementById("voiceInputBtn"); // Tetap gunakan tombol visual sebagai indikator/kontrol
const activityYearSelect = document.getElementById("activityYear");
const activityCalendarContainer = document.querySelector(".activity-calendar");
const waveformCanvas = document.getElementById('waveformCanvas');
const voicePlaybackContainer = document.getElementById('voicePlaybackContainer');
const canvasContext = waveformCanvas.getContext('2d');
¬† ¬† ¬† ¬† const overlay = document.getElementById("overlay");
¬† ¬† ¬† ¬† let currentFilter = "semua";
		let recognition; // Variabel untuk SpeechRecognition
		let isListening = false; // Status apakah sedang mendengarkan
// Variabel Perekaman Audio
let mediaRecorder;
let audioChunks = [];
let audioBlob;
let audioContext;
let analyser;
let dataArray;
let bufferLength;
let animationFrameId; // Untuk mengontrol loop animasi gelombang suara
let currentStream; // Untuk menyimpan stream mikrofon
		let finalTranscript = ''; // Untuk menyimpan transkripsi final
		let currentYear = new Date().getFullYear();
		let topics = new Set(); // Initialize the topics Set
let activitiesData = [];

		 
	
		
		
// --- Setup Pengenalan Suara ---
if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
    recognition = new (window.webkitSpeechRecognition || window.SpeechRecognition)();
    recognition.continuous = false; // Akan berhenti setelah jeda bicara
    recognition.interimResults = false; // Hanya memberikan hasil final
    recognition.lang = 'id-ID'; // Bahasa Indonesia

    recognition.onresult = function(event) {
        const transcript = event.results[0][0].transcript.trim();
        noteInput.value = transcript;
        finalTranscript = transcript;
        console.log('Transkripsi: ', transcript);
        stopListening(); // Secara otomatis menghentikan mendengarkan
        addNoteFromVoice(); // Secara otomatis mengirim catatan
    };

    recognition.onerror = function(event) {
        console.error('Terjadi kesalahan pengenalan suara', event);
        alert('Terjadi kesalahan pada fitur suara. Pastikan mikrofon Anda berfungsi dan izin telah diberikan.');
        isListening = false;
        updateVoiceButtonUI();
        stopRecording(); // Juga hentikan perekaman jika ada error
    };

    recognition.onend = function() {
        console.log('Pengenalan suara berakhir.');
        isListening = false;
        updateVoiceButtonUI();
        stopRecording(); // Pastikan perekaman berhenti saat pengenalan suara berakhir
    };
} else {
    console.log('API SpeechRecognition tidak didukung di browser ini.');
    if (voiceInputBtn) {
        voiceInputBtn.style.display = 'none'; // Sembunyikan tombol jika tidak didukung
    }
    alert('Browser Anda tidak mendukung fitur pengenalan suara.');
}

// --- Logika Tombol Suara ---
if (voiceInputBtn) {
    voiceInputBtn.addEventListener('click', () => {
        if (!isListening) {
            startListening();
        } else {
            stopListening();
        }
    });
}

function updateVoiceButtonUI() {
    if (voiceInputBtn) {
        voiceInputBtn.classList.toggle('active', isListening);
    }
}

// --- Fungsi Gabungan Mulai/Berhenti Mendengarkan & Merekam ---
async function startListening() {
    if (recognition && !isListening) {
        try {
            // Meminta akses mikrofon untuk pengenalan suara dan perekaman audio
            currentStream = await navigator.mediaDevices.getUserMedia({ audio: true });
            console.log('Akses mikrofon diberikan.');

            // Mulai pengenalan suara
            recognition.start();
            isListening = true;
            updateVoiceButtonUI();
            console.log('Mendengarkan dimulai.');

            // Mulai perekaman audio
            startRecording(currentStream);

            // Setup dan mulai visualisasi gelombang suara
            setupWaveform(currentStream);

        } catch (error) {
            console.error('Kesalahan saat memulai pengenalan suara atau mengakses mikrofon:', error);
            alert('Tidak dapat memulai fitur suara. Pastikan izin mikrofon telah diberikan.');
            isListening = false;
            updateVoiceButtonUI();
            stopRecording(); // Pastikan perekaman tidak menggantung
        }
    }
}

function stopListening() {
    if (recognition && isListening) {
        recognition.stop();
        console.log('Mendengarkan dihentikan.');
        isListening = false;
        updateVoiceButtonUI();
        stopRecording(); // Hentikan perekaman audio
        cancelAnimationFrame(animationFrameId); // Hentikan animasi gelombang suara
        clearWaveform(); // Bersihkan kanvas
        if (currentStream) {
            currentStream.getTracks().forEach(track => track.stop()); // Hentikan stream mikrofon
            currentStream = null;
        }
    }
}

// --- Fungsi Perekaman Audio ---
function startRecording(stream) {
    audioChunks = []; // Bersihkan chunk sebelumnya
    audioBlob = null; // Bersihkan blob sebelumnya

    mediaRecorder = new MediaRecorder(stream);

    mediaRecorder.ondataavailable = event => {
        audioChunks.push(event.data);
    };

    mediaRecorder.onstop = () => {
        // Buat satu blob dari semua chunk
        audioBlob = new Blob(audioChunks, { type: 'audio/webm' }); // Format umum
        console.log('Audio direkam:', audioBlob);
        playRecordedAudio(); // Putar segera setelah perekaman berhenti
    };

    mediaRecorder.onerror = event => {
        console.error('Kesalahan MediaRecorder:', event);
        alert('Terjadi kesalahan saat merekam audio.');
        stopListening(); // Hentikan semuanya jika ada error
    };

    mediaRecorder.start();
    console.log('Perekaman dimulai.');
}

function stopRecording() {
    if (mediaRecorder && mediaRecorder.state === 'recording') {
        mediaRecorder.stop();
        // Event handler onstop akan dipicu, yang kemudian memanggil playRecordedAudio()
    }
}

// --- Fungsi Pemutaran Audio ---
function playRecordedAudio() {
    voicePlaybackContainer.innerHTML = ''; // Bersihkan audio player sebelumnya
    if (audioBlob) {
        const audioUrl = URL.createObjectURL(audioBlob);
        const audioElement = document.createElement('audio');
        audioElement.controls = true; // Tampilkan kontrol (putar/jeda, volume)
        audioElement.src = audioUrl;
        voicePlaybackContainer.appendChild(audioElement);
        console.log('Memutar audio yang direkam.');

        // Bersihkan URL saat elemen audio tidak lagi diperlukan
        audioElement.onended = () => {
            URL.revokeObjectURL(audioUrl);
            console.log('URL audio dicabut (setelah selesai).');
        };
        audioElement.onpause = () => {
            // Opsional: cabut URL saat dijeda jika tidak akan diputar lagi
            // URL.revokeObjectURL(audioUrl);
            // console.log('URL audio dicabut (saat dijeda).');
        };
        audioElement.onplay = () => {
            // Pastikan URL sudah dibuat saat diputar
            if (!audioElement.src || !audioElement.src.startsWith('blob:')) {
                 audioElement.src = URL.createObjectURL(audioBlob);
            }
        };
    } else {
        console.warn('Tidak ada audio yang direkam untuk diputar.');
    }
}

// --- Fungsi Visualisasi Gelombang Suara ---
function setupWaveform(stream) {
    // Pastikan hanya ada satu AudioContext aktif
    if (audioContext) {
        audioContext.close(); // Tutup konteks sebelumnya jika ada
    }
    audioContext = new (window.AudioContext || window.webkitAudioContext)();
    const source = audioContext.createMediaStreamSource(stream);
    analyser = audioContext.createAnalyser();
    analyser.fftSize = 2048; // Sesuaikan untuk detail vs. performa (harus pangkat 2)
    bufferLength = analyser.frequencyBinCount; // Setengah dari fftSize
    dataArray = new Uint8Array(bufferLength); // Data untuk domain waktu (gelombang suara)

    source.connect(analyser);
    // analyser.connect(audioContext.destination); // Hapus komentar ini jika ingin mendengar input mikrofon langsung

    // Mulai loop menggambar
    drawWaveform();
}

function drawWaveform() {
    animationFrameId = requestAnimationFrame(drawWaveform); // Loop animasi

    if (!analyser || !dataArray) {
        return; // Keluar jika belum diinisialisasi
    }

    analyser.getByteTimeDomainData(dataArray); // Dapatkan data gelombang suara

    // Bersihkan kanvas untuk menggambar ulang
    canvasContext.clearRect(0, 0, waveformCanvas.width, waveformCanvas.height);

    canvasContext.lineWidth = 2;
    canvasContext.strokeStyle = '#3498db'; // Warna garis gelombang suara
    canvasContext.beginPath();

    const sliceWidth = waveformCanvas.width * 1.0 / bufferLength;
    let x = 0;

    for (let i = 0; i < bufferLength; i++) {
        const v = dataArray[i] / 128.0; // Normalisasi data (0-255 menjadi 0-2)
        const y = v * waveformCanvas.height / 2; // Petakan ke tinggi kanvas

        if (i === 0) {
            canvasContext.moveTo(x, y);
        } else {
            canvasContext.lineTo(x, y);
        }

        x += sliceWidth;
    }

    canvasContext.lineTo(waveformCanvas.width, waveformCanvas.height / 2); // Sambungkan ke ujung
    canvasContext.stroke();
}

function clearWaveform() {
    canvasContext.clearRect(0, 0, waveformCanvas.width, waveformCanvas.height);
}

// --- Logika Pengiriman Catatan (tanpa Firebase) ---
function addNoteFromVoice() {
    const text = finalTranscript.trim();
    if (!text) {
        console.log('Tidak ada transkripsi untuk ditambahkan sebagai catatan.');
        return;
    }

    // Karena kita tidak menggunakan Firebase, catatan ini hanya akan ditampilkan di UI.
    // Anda bisa menyimpan catatan ini ke LocalStorage atau mengirimkannya ke backend lain jika perlu.
    console.log('Catatan Suara (Teks):', text);
    console.log('Catatan Suara (Blob Audio - hanya sisi klien):', audioBlob);

    // Contoh: Tampilkan catatan di UI
    // Hapus pesan default
    if (notesList.querySelector('p')) {
        notesList.querySelector('p').remove();
    }

    const newNoteText = document.createElement('p');
    newNoteText.innerHTML = `<strong>Catatan Terbaru:</strong> "${text}"`;
    notesList.appendChild(newNoteText);

    // Reset untuk catatan berikutnya
    finalTranscript = '';
    noteInput.value = '';
}

// Bersihkan kanvas gelombang suara saat halaman dimuat
clearWaveform();
		
		
		
	
		
		

document.addEventListener('DOMContentLoaded', () => {
    // Ambil semua elemen DOM di awal untuk menghindari null checks berulang
    const loginForm = document.getElementById('loginForm');
    const dashboardDiv = document.getElementById('dashboardDiv');
    const dashboardGreetingName = document.getElementById('dashboardGreetingName');
    const emailInput = document.getElementById('email');
    const passwordInput = document.getElementById('password');
    const errorMessage = document.getElementById('errorMessage');
    const showSavedNotesBtn = document.getElementById("showSavedNotesBtn");
    const savedNotesModal = document.getElementById("savedNotesModal");
    const savedNotesContainer = document.getElementById("savedNotesContainer");
    const topicFilter = document.getElementById("topicFilter");
    const closeSavedNotesModalBtn = document.getElementById("closeSavedNotesModalBtn");
    const logoutButton = document.getElementById('logoutButton');
	// --- Pesan (Chat) Feature ---
const messageInput = document.getElementById('messageInput');
const messageBox = document.getElementById('messageBox');

    // Elemen untuk otentikasi email/kata sandi
    const emailLoginButton = document.getElementById('emailLoginBtn');
    const emailSignupButton = document.getElementById('emailSignupBtn');
    // New: Elemen untuk otentikasi anonim
    const anonymousLoginBtn = document.getElementById('anonymousLoginBtn'); 

    let unsubscribeNotes; // Variabel untuk menyimpan fungsi unsubscribe listener Firestore
    let topics = new Set(); // Set untuk menyimpan topik unik
	let unsubscribeMessages; // To store the unsubscribe function for the message listener


    // --- Helper function untuk menampilkan/menyembunyikan elemen dengan animasi ---
    function animateTransition(elementToShow, elementToHide, initialDelay = 0, hideDelay = 500) {
        if (elementToHide && !elementToHide.classList.contains("hidden")) {
            elementToHide.classList.remove("slide-in");
            elementToHide.classList.add("slide-out");
            setTimeout(() => {
                elementToHide.classList.add("hidden");
                elementToHide.classList.remove("slide-out");
                if (elementToShow) {
                    elementToShow.classList.remove("hidden");
                    elementToShow.classList.add("slide-in");
                }
            }, hideDelay);
        } else if (elementToShow && elementToShow.classList.contains("hidden")) {
            setTimeout(() => {
                elementToShow.classList.remove("hidden");
                elementToShow.classList.add("slide-in");
            }, initialDelay);
        }
    }

    // --- Success Message Popup ---
    function showSuccessMessage(message) {
        let popup = document.getElementById("success-popup") || createSuccessPopup();
        popup.textContent = message;
        popup.classList.add("show");
        setTimeout(() => popup.classList.remove("show"), 3000);
    }

    function createSuccessPopup() {
        const popup = document.createElement("div");
        popup.id = "success-popup";
        popup.className = "popup";
        popup.style.cssText = `
            position: fixed; top: 20px; right: 20px;
            background-color: #10b981; color: white;
            padding: 14px 20px; border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            font-weight: 500; opacity: 0; pointer-events: none;
            transition: all 0.4s ease; z-index: 1000;
        `;
        document.body.appendChild(popup);
        return popup;
    }

    // --- Common UI Update after successful login ---
    function updateUIOnLoginSuccess(user) {
        // Fallback untuk display name jika tidak tersedia (misal: hanya login email atau anonim)
        const displayName = user.displayName || (user.isAnonymous ? "Tamu" : (user.email ? user.email.split("@")[0] : "Pengguna"));

        if (loginForm) {
            loginForm.classList.add("hidden");
        }
        // Pastikan dashboardDiv muncul dan animasi slide-in
        if (dashboardDiv) {
            dashboardDiv.classList.remove("hidden");
            dashboardDiv.classList.add("slide-in");
        }
        // Assuming greetingDiv is meant to be the main greeting display, not dashboardDiv
        const greetingDiv = document.getElementById('greetingDiv'); 
        if (greetingDiv) {
            greetingDiv.classList.remove("hidden");
            greetingDiv.classList.add("slide-in");
        }
        if (document.getElementById('userGreeting')) { // Corrected ID to userGreeting as in HTML
            document.getElementById('userGreeting').textContent = `Halo, ${displayName}!`;
        }
        if (errorMessage) {
            errorMessage.classList.add("hidden"); // Sembunyikan pesan error sebelumnya
        }
        // Panggil setupSavedNotesListener di sini agar listener aktif setelah login
        setupSavedNotesListener();
    }

    // --- Email/Password Signup Function ---
    async function signupWithEmail() {
        const email = emailInput.value;
        const password = passwordInput.value;

        if (!email || !password) {
            errorMessage.textContent = "Email dan password tidak boleh kosong.";
            errorMessage.classList.remove("hidden");
            return;
        }

        // Pastikan modul Firebase Auth tersedia
        if (typeof auth === 'undefined' || typeof createUserWithEmailAndPassword === 'undefined') {
            console.error("Firebase Auth modules (createUserWithEmailAndPassword) tidak dimuat atau tidak terdefinisi.");
            errorMessage.textContent = "Error: Fitur pendaftaran tidak tersedia. Pastikan Firebase Auth sudah diinisialisasi.";
            errorMessage.classList.remove("hidden");
            return;
        }

        try {
            // Nonaktifkan tombol dan tampilkan pesan loading
            if (emailSignupButton) {
                emailSignupButton.disabled = true;
                emailSignupButton.textContent = "Mendaftar...";
            }
            if (emailLoginButton) emailLoginButton.disabled = true;
            if (anonymousLoginBtn) anonymousLoginBtn.disabled = true; // Disable anonymous button too

            const userCredential = await createUserWithEmailAndPassword(auth, email, password);
            updateUIOnLoginSuccess(userCredential.user);
            showSuccessMessage("Pendaftaran berhasil! Selamat datang.");
        } catch (error) {
            console.error("Email signup error:", error);
            let userMessage = "Pendaftaran gagal. Silakan coba lagi.";
            if (error.code === 'auth/email-already-in-use') {
                userMessage = "Email sudah terdaftar. Silakan login atau gunakan email lain.";
            } else if (error.code === 'auth/invalid-email') {
                userMessage = "Format email tidak valid.";
            } else if (error.code === 'auth/weak-password') {
                userMessage = "Kata sandi terlalu lemah (minimal 6 karakter).";
            }
            errorMessage.textContent = `Pendaftaran gagal: ${userMessage}`;
            errorMessage.classList.remove("hidden");
        } finally {
            // Aktifkan kembali tombol
            if (emailSignupButton) {
                emailSignupButton.disabled = false;
                emailSignupButton.textContent = "Daftar";
            }
            if (emailLoginButton) emailLoginButton.disabled = false;
            if (anonymousLoginBtn) anonymousLoginBtn.disabled = false; // Re-enable anonymous button
        }
    }

    // --- Email/Password Login Function ---
    async function loginWithEmail() {
        const email = emailInput.value;
        const password = passwordInput.value;

        if (!email || !password) {
            errorMessage.textContent = "Email dan password tidak boleh kosong.";
            errorMessage.classList.remove("hidden");
            return;
        }

        // Pastikan modul Firebase Auth tersedia
        if (typeof auth === 'undefined' || typeof signInWithEmailAndPassword === 'undefined') {
            console.error("Firebase Auth modules (signInWithEmailAndPassword) tidak dimuat atau tidak terdefinisi.");
            errorMessage.textContent = "Error: Fitur login tidak tersedia. Pastikan Firebase Auth sudah diinisialisasi.";
            errorMessage.classList.remove("hidden");
            return;
        }

        try {
            // Nonaktifkan tombol dan tampilkan pesan loading
            if (emailLoginButton) {
                emailLoginButton.disabled = true;
                emailLoginButton.textContent = "Masuk...";
            }
            if (emailSignupButton) emailSignupButton.disabled = true;
            if (anonymousLoginBtn) anonymousLoginBtn.disabled = true; // Disable anonymous button

            const userCredential = await signInWithEmailAndPassword(auth, email, password);
            updateUIOnLoginSuccess(userCredential.user);
            showSuccessMessage("Login berhasil! Selamat datang kembali.");
        } catch (error) {
            console.error("Email login error:", error);
            let userMessage = "Login gagal. Silakan coba lagi.";
            if (error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password') {
                userMessage = "Email atau kata sandi salah.";
            } else if (error.code === 'auth/invalid-email') {
                userMessage = "Format email tidak valid.";
            }
            errorMessage.textContent = `Login gagal: ${userMessage}`;
            errorMessage.classList.remove("hidden");
        } finally {
            // Aktifkan kembali tombol
            if (emailLoginButton) {
                emailLoginButton.disabled = false;
                emailLoginButton.textContent = "Login";
            }
            if (emailSignupButton) emailSignupButton.disabled = false;
            if (anonymousLoginBtn) anonymousLoginBtn.disabled = false; // Re-enable anonymous button
        }
    }

    // --- Anonymous Sign-in Function (NEW) ---
    async function signInAnonymouslyFirebase() {
        // Pastikan modul Firebase Auth tersedia
        if (typeof auth === 'undefined' || typeof signInAnonymously === 'undefined') {
            console.error("Firebase Auth module (signInAnonymously) tidak dimuat atau tidak terdefinisi.");
            errorMessage.textContent = "Error: Fitur login anonim tidak tersedia. Pastikan Firebase Auth sudah diinisialisasi.";
            errorMessage.classList.remove("hidden");
            return;
        }

        try {
            // Nonaktifkan tombol dan tampilkan pesan loading
            if (anonymousLoginBtn) {
                anonymousLoginBtn.disabled = true;
                anonymousLoginBtn.textContent = "Masuk...";
            }
            if (emailLoginButton) emailLoginButton.disabled = true;
            if (emailSignupButton) emailSignupButton.disabled = true;

            const userCredential = await signInAnonymously(auth);
            updateUIOnLoginSuccess(userCredential.user);
            showSuccessMessage("Berhasil masuk sebagai tamu.");
        } catch (error) {
            console.error("Anonymous sign-in error:", error);
            errorMessage.textContent = `Gagal masuk sebagai tamu: ${error.message}`;
            errorMessage.classList.remove("hidden");
        } finally {
            // Aktifkan kembali tombol
            if (anonymousLoginBtn) {
                anonymousLoginBtn.disabled = false;
                anonymousLoginBtn.textContent = "Masuk Sebagai Tamu";
            }
            if (emailLoginButton) emailLoginButton.disabled = false;
            if (emailSignupButton) emailSignupButton.disabled = false;
        }
    }

    // --- Fungsi Logout ---
    function logout() {
        // Pastikan modul Firebase Auth tersedia
        if (typeof auth === 'undefined' || typeof signOut === 'undefined') {
            console.error("Firebase Auth signOut module tidak dimuat atau tidak terdefinisi.");
            showSuccessMessage("Error: Fitur logout tidak tersedia.");
            return;
        }
        signOut(auth)
            .then(() => {
                const greetingDiv = document.getElementById('greetingDiv'); // Get greetingDiv here
                if (greetingDiv && loginForm) { // Animate transition from greetingDiv to loginForm
                    animateTransition(loginForm, greetingDiv); 
                    // Reset input fields after logout
                    if (emailInput) emailInput.value = "";
                    if (passwordInput) passwordInput.value = "";
                }
                if (errorMessage) errorMessage.classList.add("hidden"); // Sembunyikan pesan error
                showSuccessMessage("Anda telah berhasil logout.");

                // Hentikan listener catatan saat logout
                if (unsubscribeNotes) {
                    unsubscribeNotes();
                    unsubscribeNotes = null;
                    console.log("Listener catatan sebelumnya telah dihentikan.");
                }
            })
            .catch((error) => {
                console.error("Logout error:", error);
                if (errorMessage) {
                    errorMessage.textContent = `Logout gagal: ${error.message}`;
                    errorMessage.classList.remove("hidden");
                }
            });
    }

    // --- Toggle Save Note (Operasi Firestore) ---
    async function toggleSaveNote(noteId, isCurrentlySaved, noteData) {
        const userId = auth.currentUser?.uid;
        if (!userId) {
            showSuccessMessage("Anda perlu login untuk menyimpan catatan.");
            return;
        }
        // Pastikan modul Firestore tersedia
        if (typeof db === 'undefined' || typeof doc === 'undefined' || typeof setDoc === 'undefined' || typeof updateDoc === 'undefined' || typeof serverTimestamp === 'undefined') {
            console.error("Firestore modules tidak dimuat untuk menyimpan catatan.");
            showSuccessMessage("Error: Database tidak tersedia.");
            return;
        }

        const noteRef = doc(db, "users", userId, "notes", noteId);

        try {
            if (!isCurrentlySaved) {
                // Pastikan noteData memiliki properti yang diperlukan dan merge true
                await setDoc(noteRef, { ...noteData, isSaved: true, savedAt: serverTimestamp() }, { merge: true });
                showSuccessMessage("Catatan disimpan!");
            } else {
                await updateDoc(noteRef, { isSaved: false });
                showSuccessMessage("Catatan dibatalkan penyimpanannya.");
            }
        } catch (err) {
            console.error("Toggle save note error:", err);
            showSuccessMessage("Gagal mengubah status simpan catatan.");
        }
    }

    // --- Filter Catatan berdasarkan Topik ---
    function filterNotesByTopic(selectedTopic) {
        if (!savedNotesContainer) return;
        const notes = savedNotesContainer.querySelectorAll(".note");
        notes.forEach((note) => {
            const noteTopic = note.dataset.topic || "";
            // Perbandingan topik case-insensitive
            note.style.display = (selectedTopic === "all" || selectedTopic === "" || noteTopic === selectedTopic.toLowerCase())
                ? "block"
                : "none";
        });
    }

    // --- Tampilkan Catatan Tersimpan di Popup ---
    function displaySavedNotesPopup(savedNotes = []) {
        if (!savedNotesModal || !savedNotesContainer || !topicFilter) {
            console.warn("Satu atau lebih elemen modal tidak ditemukan. Tidak dapat menampilkan popup catatan tersimpan.");
            return;
        }

        savedNotesContainer.innerHTML = ""; // Clear the container before adding new notes
        topics.clear(); // Clear the topic list (assuming 'topics' is a Set or similar global/scoped variable)

        if (savedNotes.length === 0) {
            savedNotesContainer.innerHTML = "<p style='text-align: center; padding: 20px; color: #666;'>Belum ada catatan yang tersimpan.</p>";
            topicFilter.value = "all";
            topicFilter.innerHTML = '<option value="all">Semua Topik</option>';
            // If no notes, ensure the filter reflects this.
        } else {
            savedNotes.forEach((docSnap) => {
                const data = docSnap.data();

                // Prioritize content, then text if title/content are not explicitly set
                // For 'susah' type of input, 'content' is the primary field.
                const title = data.title || 'Tidak Ada Judul'; // Default title if not explicitly saved
                const content = data.content || data.text || 'Tidak Ada Konten'; // Use data.content or data.text (if raw input is saved as 'text')

                // Ensure topic defaults to 'lainlain' as shown in your design
                const topic = (data.topic || data.temaTopik || "lainlain").toLowerCase();

                // Only add unique topics to the filter, excluding the default 'lainlain' if it's not a specific topic
                if (topic && topic !== "lainlain") {
                    topics.add(topic);
                }

                const noteEl = document.createElement('div');
                noteEl.classList.add("note");
                noteEl.dataset.topic = topic; // Store topic in dataset for filtering

                // Prepare data for the toggleSaveNote function
                const noteDataForToggle = JSON.stringify({
                    title: title,
                    content: content,
                    topic: topic,
                    id: docSnap.id
                }).replace(/"/g, '&quot;');


                noteEl.innerHTML = `
                    <h3>${title}</h3>
                    <p>${content}</p>
                    <p style="font-size: 0.9em; color: #666;">Topik: ${topic.charAt(0).toUpperCase() + topic.slice(1)}</p>
                    <button class="save-toggle-btn" onclick="toggleSaveNote('${docSnap.id}', true, ${noteDataForToggle})">Batalkan Simpan</button>
                `;
                savedNotesContainer.appendChild(noteEl);
            });

            // Repopulate topic filter
            topicFilter.innerHTML = '<option value="all">Semua Topik</option>';
            Array.from(topics).sort().forEach((topic) => {
                const option = document.createElement("option");
                option.value = topic;
                option.textContent = topic.charAt(0).toUpperCase() + topic.slice(1);
                topicFilter.appendChild(option);
            });

            topicFilter.value = "all"; // Reset to "all" every time notes are updated
            filterNotesByTopic("all"); // Display all notes by default
        }

        savedNotesModal.style.display = "flex"; // Show the modal

        // Ensure event listener for topic filter is only added once
        function topicFilterChangeListener() {
            filterNotesByTopic(topicFilter.value);
        }
        topicFilter.removeEventListener("change", topicFilterChangeListener);
        topicFilter.addEventListener("change", topicFilterChangeListener);
    }


    // --- Setup Real-time Listener untuk Catatan Tersimpan ---
    function setupSavedNotesListener() {
        if (!auth.currentUser) {
            console.log("Tidak ada pengguna yang login, tidak dapat mengatur listener catatan.");
            return;
        }
        // Pastikan modul Firestore tersedia
        if (typeof db === 'undefined' || typeof collection === 'undefined' || typeof query === 'undefined' || typeof where === 'undefined' || typeof onSnapshot === 'undefined') {
            console.error("Firestore real-time listener modules tidak dimuat.");
            showSuccessMessage("Error: Listener catatan tidak tersedia.");
            return;
        }

        const userId = auth.currentUser.uid;
        const q = query(
            collection(db, "users", userId, "notes"),
            where("isSaved", "==", true)
        );

        // Hentikan listener yang ada sebelum membuat yang baru
        if (unsubscribeNotes) {
            unsubscribeNotes();
            console.log("Listener catatan sebelumnya telah dihentikan.");
        }

        unsubscribeNotes = onSnapshot(q, (snapshot) => {
            const savedNotes = snapshot.docs;
            displaySavedNotesPopup(savedNotes); // Perbarui tampilan catatan
        }, (error) => {
            console.error("Error fetching saved notes:", error);
            showSuccessMessage("Gagal memuat catatan tersimpan.");
        });
        console.log("Listener catatan tersimpan telah diatur.");
    }

    // --- Authentication State Change Listener ---
    function onAuthStateChangedHandler() {
        // Pastikan modul Firebase Auth tersedia
        if (typeof auth === 'undefined' || typeof onAuthStateChanged === 'undefined') {
            console.error("Firebase Auth onAuthStateChanged module tidak dimuat atau tidak terdefinisi.");
            return;
        }
        onAuthStateChanged(auth, (user) => {
            const greetingDiv = document.getElementById('greetingDiv'); // Get greetingDiv here
            if (user) {
                // Pengguna masuk.
                updateUIOnLoginSuccess(user);
            } else {
                // Pengguna keluar.
                // Animasikan kembali ke login form jika dashboard atau greetingDiv terlihat
                if ((dashboardDiv && !dashboardDiv.classList.contains("hidden")) || (greetingDiv && !greetingDiv.classList.contains("hidden"))) {
                    // Decide which one to hide based on which is visible
                    const elementToHide = dashboardDiv && !dashboardDiv.classList.contains("hidden") ? dashboardDiv : greetingDiv;
                    animateTransition(loginForm, elementToHide);
                } else if (loginForm) {
                    loginForm.classList.remove("hidden");
                }
                
                // Reset input fields setelah logout
                if (emailInput) emailInput.value = "";
                if (passwordInput) passwordInput.value = "";

                // Hentikan listener catatan saat logout atau tidak ada user
                if (unsubscribeNotes) {
                    unsubscribeNotes();
                    unsubscribeNotes = null;
                    console.log("Listener catatan telah dihentikan karena tidak ada pengguna.");
                }
            }
        });
    }

    // --- Penugasan Event Listener ---
    // Tombol login email
    if (emailLoginButton) {
        emailLoginButton.addEventListener('click', loginWithEmail);
    } else {
        console.warn("Elemen 'emailLoginBtn' tidak ditemukan di DOM. Tombol login email tidak akan berfungsi.");
    }

    // Tombol daftar email
    if (emailSignupButton) {
        emailSignupButton.addEventListener('click', signupWithEmail);
    } else {
        console.warn("Elemen 'emailSignupBtn' tidak ditemukan di DOM. Tombol daftar email tidak akan berfungsi.");
    }

    // New: Tombol login anonim
    if (anonymousLoginBtn) {
        anonymousLoginBtn.addEventListener('click', signInAnonymouslyFirebase);
    } else {
        console.warn("Elemen 'anonymousLoginBtn' tidak ditemukan di DOM. Tombol login anonim tidak akan berfungsi.");
    }

    // Tombol tampilkan catatan tersimpan
    if (showSavedNotesBtn) {
        showSavedNotesBtn.addEventListener('click', () => {
            if (auth && auth.currentUser) {
                // Karena setupSavedNotesListener sudah dipanggil di updateUIOnLoginSuccess,
                // kita hanya perlu menampilkan modal di sini.
                if (savedNotesModal) {
                    savedNotesModal.style.display = "flex";
                }
            } else {
                showSuccessMessage("Anda perlu login untuk melihat catatan tersimpan.");
            }
        });
    } else {
        console.warn("Elemen 'showSavedNotesBtn' tidak ditemukan di DOM. Tombol tampilkan catatan tidak akan berfungsi.");
    }

    // Tombol tutup modal catatan tersimpan
    if (closeSavedNotesModalBtn) {
        closeSavedNotesModalBtn.addEventListener('click', () => {
            if (savedNotesModal) savedNotesModal.style.display = "none";
            // Penting: Hentikan listener saat modal ditutup untuk mencegah kebocoran memori
            if (unsubscribeNotes) {
                unsubscribeNotes();
                unsubscribeNotes = null;
                console.log("Listener catatan telah dihentikan saat modal ditutup.");
            }
        });
    } else {
        console.warn("Elemen 'closeSavedNotesModalBtn' tidak ditemukan di DOM. Tombol tutup modal catatan tidak akan berfungsi.");
    }

    // Tombol logout
    if (logoutButton) {
        logoutButton.addEventListener('click', logout);
    } else {
        console.warn("Elemen 'logoutButton' tidak ditemukan di DOM. Tombol logout tidak akan berfungsi.");
    }

    // Tutup Modal saat Klik di Luar
    window.addEventListener("click", (event) => {
        if (savedNotesModal && event.target === savedNotesModal) {
            savedNotesModal.style.display = "none";
            // Penting: Hentikan listener saat modal ditutup dari luar
            if (unsubscribeNotes) {
                unsubscribeNotes();
                unsubscribeNotes = null;
                console.log("Listener catatan telah dihentikan saat modal ditutup dari luar.");
            }
        }
    });
	
	
// Function to generate a simple profile picture initial
function getProfilePicInitial(displayName) {
    if (displayName) {
        return displayName.charAt(0).toUpperCase();
    }
    return '?';
}

// Function to send a message
async function sendMessage() {
    const user = auth.currentUser;
    if (!user) {
        showSuccessMessage("Anda perlu login untuk mengirim pesan.");
        return;
    }
    const messageText = messageInput.value.trim();
    if (messageText === "") {
        return;
    }

    // Ensure Firestore modules are available
    if (typeof db === 'undefined' || typeof collection === 'undefined' || typeof addDoc === 'undefined' || typeof serverTimestamp === 'undefined') {
        console.error("Firebase Firestore modules tidak dimuat untuk mengirim pesan.");
        showSuccessMessage("Error: Fitur pesan tidak tersedia.");
        return;
    }

    try {
        const displayName = user.displayName || (user.email ? user.email.split('@')[0] : 'Anonim');
        await addDoc(collection(db, "messages"), {
            uid: user.uid,
            sender: displayName,
            text: messageText,
            timestamp: serverTimestamp()
        });
        messageInput.value = ""; // Clear input after sending
        messageBox.scrollTop = messageBox.scrollHeight; // Scroll to bottom
    } catch (error) {
        console.error("Error sending message:", error);
        showSuccessMessage("Gagal mengirim pesan: " + error.message);
    }
}

// Function to listen for real-time messages
function setupMessageListener() {
    // Ensure Firestore modules are available
    if (typeof db === 'undefined' || typeof collection === 'undefined' || typeof query === 'undefined' || typeof orderBy === 'undefined' || typeof onSnapshot === 'undefined') {
        console.error("Firebase Firestore real-time message listener modules tidak dimuat.");
        return;
    }

    // Stop any existing listener before creating a new one
    if (unsubscribeMessages) {
        unsubscribeMessages();
        console.log("Previous message listener has been stopped.");
    }

    const messagesRef = collection(db, "messages");
    const q = query(messagesRef, orderBy("timestamp", "asc"));

    unsubscribeMessages = onSnapshot(q, (snapshot) => {
        messageBox.innerHTML = ""; // Clear existing messages
        snapshot.forEach((doc) => {
            const message = doc.data();
            const user = auth.currentUser;
            const isSender = user && message.uid === user.uid;

            const messageContainer = document.createElement('div');
            messageContainer.classList.add('message-container');
            messageContainer.classList.add(isSender ? 'sent' : 'received');

            const profilePicDiv = document.createElement('div');
            profilePicDiv.classList.add('profile-pic');
            profilePicDiv.textContent = getProfilePicInitial(message.sender);

            const messageBubble = document.createElement('div');
            messageBubble.classList.add('message-bubble');

            const senderNameEl = document.createElement('div');
            senderNameEl.classList.add('message-sender');
            senderNameEl.textContent = message.sender;

            const messageTextEl = document.createElement('p');
            messageTextEl.textContent = message.text;

            const messageInfoEl = document.createElement('div');
            messageInfoEl.classList.add('message-info');

            // Format timestamp
            let timeString = '';
            if (message.timestamp) {
                const date = message.timestamp.toDate();
                timeString = date.toLocaleString('id-ID', {
                    hour: '2-digit',
                    minute: '2-digit',
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric'
                });
            }
            messageInfoEl.textContent = timeString;

            messageBubble.appendChild(senderNameEl);
            messageBubble.appendChild(messageTextEl);
            messageBubble.appendChild(messageInfoEl);

            if (isSender) {
                messageContainer.appendChild(messageBubble);
                messageContainer.appendChild(profilePicDiv); // Profile pic on the right for sender
            } else {
                messageContainer.appendChild(profilePicDiv); // Profile pic on the left for receiver
                messageContainer.appendChild(messageBubble);
            }
            
            messageBox.appendChild(messageContainer);
        });
        messageBox.scrollTop = messageBox.scrollHeight; // Scroll to bottom on new message
    }, (error) => {
        console.error("Error listening to messages:", error);
        showSuccessMessage("Gagal memuat percakapan.");
    });
    console.log("Message listener has been set up.");
}

// Modify onAuthStateChangedHandler to start/stop message listener
function onAuthStateChangedHandler() {
    if (typeof auth === 'undefined' || typeof onAuthStateChanged === 'undefined') {
        console.error("Firebase Auth onAuthStateChanged module tidak dimuat atau tidak terdefinisi.");
        return;
    }
    onAuthStateChanged(auth, (user) => {
        const greetingDiv = document.getElementById('greetingDiv');
        if (user) {
            updateUIOnLoginSuccess(user);
            setupMessageListener(); // Start message listener when user logs in
        } else {
            if ((dashboardDiv && !dashboardDiv.classList.contains("hidden")) || (greetingDiv && !greetingDiv.classList.contains("hidden"))) {
                const elementToHide = dashboardDiv && !dashboardDiv.classList.contains("hidden") ? dashboardDiv : greetingDiv;
                animateTransition(loginForm, elementToHide);
            } else if (loginForm) {
                loginForm.classList.remove("hidden");
            }
            
            if (emailInput) emailInput.value = "";
            if (passwordInput) passwordInput.value = "";

            if (unsubscribeNotes) {
                unsubscribeNotes();
                unsubscribeNotes = null;
                console.log("Listener catatan telah dihentikan karena tidak ada pengguna.");
            }
            // Stop message listener when user logs out
            if (unsubscribeMessages) {
                unsubscribeMessages();
                unsubscribeMessages = null;
                console.log("Listener pesan telah dihentikan karena tidak ada pengguna.");
            }
            messageBox.innerHTML = ""; // Clear messages on logout
        }
    });
}

    // --- Expose functions to the global scope for inline HTML event handlers (jika diperlukan) ---
    window.logoutFirebase = logout; 
    window.toggleSaveNote = toggleSaveNote;
    window.loginWithEmail = loginWithEmail;
    window.signupWithEmail = signupWithEmail;
    window.signInAnonymouslyFirebase = signInAnonymouslyFirebase; // Expose new function
	// Ensure the sendMessage function is globally accessible for the button's onclick
window.sendMessage = sendMessage;


    // --- Inisialisasi listener status otentikasi ---
    onAuthStateChangedHandler();
});





















		

  const cookieNameConsent = 'cookieConsent';
  const cookieNameTheme = 'themePreference';
  const cookieExpiryDays = 30; // Masa berlaku cookie (dalam hari)

  // Fungsi untuk mengatur cookie
  function setCookie(name, value, days) {
    let expires = "";
    if (days) {
      const date = new Date();
      date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
      expires = "; expires=" + date.toUTCString();
    }
    document.cookie = name + "=" + (value || "") + expires + "; path=/";
    console.log('Cookie diatur:', name, '=', value);
  }

  // Fungsi untuk mendapatkan cookie
  function getCookie(name) {
    const nameEQ = name + "=";
    const ca = document.cookie.split(';');
    for (let i = 0; i < ca.length; i++) {
      let c = ca[i];
      while (c.charAt(0) === ' ') c = c.substring(1, c.length);
      if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
    }
    console.log('Cookie tidak ditemukan:', name);
    return null;
  }

  function applyThemeFromCookie() {
    const theme = getCookie(cookieNameTheme);
    if (theme) {
      document.body.classList.toggle('dark-theme', theme === 'dark');
      // Lakukan tindakan lain untuk menerapkan tema sesuai nilai cookie
      console.log('Tema diterapkan dari cookie:', theme);
    }
  }

  function showCookieNotification() {
    const cookieNotification = document.createElement('div');
    cookieNotification.className = 'cookie-notification';
    cookieNotification.innerHTML = `
      <p style="margin: 0;">Situs ini menggunakan cookies. <a href="#" id="readMoreCookies" style="color: #eee; text-decoration: underline;">Baca lebih lanjut</a> <button id="acceptCookies" style="background-color: #007bff; color: white; border: none; padding: 8px 15px; margin-left: 10px; border-radius: 5px; cursor: pointer;">Terima</button> <button id="rejectCookies" style="background-color: transparent; color: #ccc; border: none; padding: 8px 15px; margin-left: 10px; cursor: pointer;">Tolak</button></p>
    `;
    document.body.appendChild(cookieNotification);
    console.log('Notifikasi cookie ditampilkan.');

    const acceptButton = document.getElementById('acceptCookies');
    const rejectButton = document.getElementById('rejectCookies');
    const readMoreLink = document.getElementById('readMoreCookies');

    acceptButton.addEventListener('click', () => {
      setCookie(cookieNameConsent, 'accepted', cookieExpiryDays);
      cookieNotification.remove();
    });

    rejectButton.addEventListener('click', () => {
      setCookie(cookieNameConsent, 'rejected', 1);
      cookieNotification.remove();
      alert('Anda telah menolak penggunaan cookies. Beberapa fitur mungkin tidak berfungsi dengan baik.');
    });

    readMoreLink.addEventListener('click', (e) => {
      e.preventDefault();
      alert('Ini adalah informasi lebih lanjut tentang bagaimana kami menggunakan cookies...');
    });
  }

  // Cek dan tampilkan notifikasi cookie saat halaman dimuat jika belum ada persetujuan
  console.log('Memeriksa cookie consent:', getCookie(cookieNameConsent));
  if (!getCookie(cookieNameConsent)) {
    showCookieNotification();
  } else if (getCookie(cookieNameConsent) === 'accepted') {
    console.log('Cookie consent diterima.');
    // Lakukan tindakan lain jika cookie consent sudah diterima
  } else if (getCookie(cookieNameConsent) === 'rejected') {
    console.log('Cookie consent ditolak.');
    // Lakukan tindakan lain jika cookie consent ditolak (misalnya, batasi fitur tertentu)
  }

  // Contoh penyimpanan preferensi tema (misalnya, saat tombol tema diubah)
  function saveThemePreference(theme) {
    setCookie(cookieNameTheme, theme, cookieExpiryDays);
    applyThemeFromCookie(); // Terapkan tema segera
  }

  // Terapkan tema dari cookie saat halaman dimuat
  applyThemeFromCookie();
  
  const readMoreLink = document.getElementById('readMoreCookies');
const cookieExplanationModal = document.getElementById('cookieExplanation');
const closeCookieExplanationBtn = document.getElementById('closeCookieExplanation');
const acceptFromExplanationBtn = document.getElementById('acceptFromExplanation');
const cookieNotification = document.querySelector('.cookie-notification'); // Ambil notifikasi cookie

if (readMoreLink) {
    readMoreLink.addEventListener('click', (e) => {
        e.preventDefault();
        cookieExplanationModal.style.display = 'flex';
    });
}

if (closeCookieExplanationBtn) {
    closeCookieExplanationBtn.addEventListener('click', () => {
        cookieExplanationModal.style.display = 'none';
    });
}

if (acceptFromExplanationBtn && cookieNotification) {
    acceptFromExplanationBtn.addEventListener('click', () => {
        setCookie(cookieNameConsent, 'accepted', cookieExpiryDays);
        cookieExplanationModal.style.display = 'none';
        cookieNotification.remove(); // Hilangkan notifikasi setelah menerima dari penjelasan
    });
}

// Pastikan modal tertutup saat area di luar modal diklik
window.addEventListener('click', (event) => {
    if (event.target === cookieExplanationModal) {
        cookieExplanationModal.style.display = 'none';
    }
});


document.getElementById('activityYear').addEventListener('change', function (event) {
    const selectedYear = parseInt(event.target.value);

    // Asumsikan data aktivitas manual Anda ada dalam variabel bernama 'activityDataManual'
    const rawData = activity; // Ganti dengan nama variabel data manual Anda
    const filteredData = {};

    Object.keys(rawData).forEach(month => {
        filteredData[month] = rawData[month]?.filter(entry => {
            return new Date(entry.date).getFullYear() === selectedYear;
        });
    });

    // Render ulang kalender
    const calendarHTML = renderActivity(filteredData, selectedYear);
    const activityCalendarContainer = document.querySelector('.activity-calendar');
    if (activityCalendarContainer) {
        activityCalendarContainer.innerHTML = calendarHTML;
    }
});


function populateYearOptions() {
    const startYear = 2023; // Atau tahun awal data Anda
    const endYear = new Date().getFullYear() + 1;
    const selectElement = document.getElementById('activityYear'); // Pastikan Anda memiliki elemen select dengan ID ini
    if (selectElement) {
        for (let i = startYear; i <= endYear; i++) {
            const option = document.createElement('option');
            option.value = i;
            option.textContent = i;
            option.selected = i === new Date().getFullYear();
            selectElement.appendChild(option);
        }
    }
}

const activity = {
    Jan: [
        { day: "Mon", status: "baru", date: "2025-01-06" },
        { day: "Wed", status: "selesai", date: "2025-01-08" },
        // Tambahkan data aktivitas lainnya untuk bulan Januari di sini
    ],
    Feb: [
        { day: "Fri", status: "selesai", date: "2025-02-14" },
        // Tambahkan data aktivitas lainnya untuk bulan Februari di sini
    ],
    Mar: [
        { day: "Fri", status: "selesai", date: "2025-03-14" },
        // Tambahkan data aktivitas lainnya untuk bulan Maret di sini
    ],
    Apr: [
        { day: "Fri", status: "revisi", date: "2025-04-14" },
        { day: "Fri", status: "selesai", date: "2025-04-25" },
        // Tambahkan data aktivitas lainnya untuk bulan April di sini
    ],
    May: [],
    Jun: [],
    Jul: [],
    Aug: [],
    Sep: [],
    Oct: [],
    Nov: [],
    Dec: []
    // Anda bisa menambahkan data untuk bulan-bulan lainnya di sini
};

           
document.addEventListener('DOMContentLoaded', () => {
    populateYearOptions();
    const currentYear = new Date().getFullYear();
    const initialActivitiesForYear = {};
    const rawData = activity; // Gunakan variabel 'activity' yang berisi data bulanan
    for (const month in rawData) {
        initialActivitiesForYear[month] = rawData[month]?.filter(item => { // Gunakan 'item' sebagai parameter filter
            return new Date(item.date).getFullYear() === currentYear;
        });
    }
    const activityCalendarContainer = document.querySelector('.activity-calendar');
    if (activityCalendarContainer) {
        activityCalendarContainer.innerHTML = renderActivity(initialActivitiesForYear, currentYear);
    }
});


const notificationIconDiv = document.getElementById('notificationIcon');
const notificationPopupDiv = document.getElementById('notificationPopup');
const notificationListItemsUl = document.getElementById('notificationListItems');
const markAllReadButton = document.getElementById('markAllRead');
const notificationCountSpan = document.getElementById('notificationCount');
const closeNotificationPopup = document.getElementById('closeNotificationPopup');
const notificationFullContentDiv = document.getElementById('notificationFullContent');
const fullNotificationPopupDiv = document.createElement('div');
fullNotificationPopupDiv.id = 'fullNotificationPopup';
fullNotificationPopupDiv.style.cssText = `
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.5);
    display: none;
    z-index: 1001;
    overflow-y: auto;
`;
const fullNotificationContentDiv = document.createElement('div');
fullNotificationContentDiv.style.cssText = `
    background-color: white;
    width: 80%;
    max-width: 600px;
    border-radius: 8px;
    margin: 50px auto;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    position: relative;
    padding: 20px;
`;
const fullNotificationCloseButton = document.createElement('button');
fullNotificationCloseButton.innerHTML = '&times;';
fullNotificationCloseButton.style.cssText = `
    position: absolute;
    top: 10px;
    right: 10px;
    border: none;
    background: none;
    font-size: 1.5em;
    cursor: pointer;
    color: #888;
`;

fullNotificationContentDiv.appendChild(fullNotificationCloseButton);
fullNotificationPopupDiv.appendChild(fullNotificationContentDiv);
document.body.appendChild(fullNotificationPopupDiv);

let unreadNotifications = 0;
let notifications = [];
let currentNotificationIndex = null;

function updateNotificationCount() {
    notificationCountSpan.textContent = unreadNotifications;
    notificationCountSpan.style.display = unreadNotifications > 0 ? 'inline-block' : 'none';
}

function addNotification(notification) {
    notifications.unshift(notification);
    if (!notification.read) {
        unreadNotifications++;
        updateNotificationCount();
    }
    updateNotificationDisplay();
}

function updateNotificationDisplay() {
    notificationListItemsUl.innerHTML = '';
    if (notifications.length === 0) {
        const emptyMessage = document.createElement('li');
        emptyMessage.textContent = 'Tidak ada notifikasi baru';
        notificationListItemsUl.appendChild(emptyMessage);
    } else {
        notifications.forEach((notif, index) => {
            const listItem = document.createElement('li');
            listItem.className = 'notification-item';
            listItem.style.cursor = 'pointer';
            listItem.style.padding = '10px';
            listItem.style.borderBottom = '1px solid #eee';

            const categorySpan = document.createElement('span');
            categorySpan.className = 'notification-category';
            categorySpan.style.borderRadius = '4px';
            categorySpan.style.padding = '5px 8px';
            categorySpan.style.fontSize = '0.8em';
            categorySpan.style.fontWeight = 'bold';
            categorySpan.style.marginRight = '8px';

            if (notif.type === 'maintenance') {
                categorySpan.textContent = '[maintenance]';
                categorySpan.style.backgroundColor = '#ffe082';
                categorySpan.style.color = '#7a5206';
            } else if (notif.type === 'blog') {
                categorySpan.textContent = '[blog & note]';
                categorySpan.style.backgroundColor = '#b2ebf2';
                categorySpan.style.color = '#006064';
            } else {
                categorySpan.textContent = '[Info Umum]';
                categorySpan.style.backgroundColor = '#d1c4e9';
                categorySpan.style.color = '#311b92';
            }

            const titleSpan = document.createElement('span');
            titleSpan.className = 'notification-title';
            titleSpan.textContent = notif.title || 'No Title';
            titleSpan.style.display = 'block';
            titleSpan.style.textAlign = 'left';
            titleSpan.style.fontWeight = 'bold';
            titleSpan.style.marginBottom = '5px';

            listItem.appendChild(categorySpan);
            listItem.appendChild(titleSpan);

            listItem.addEventListener('click', (event) => {
                showFullNotificationPopup(index);
                markNotificationAsRead(index);
                event.stopPropagation();
            });

            notificationListItemsUl.appendChild(listItem);
        });
    }
}

function markNotificationAsRead(index) {
    if (notifications[index] && !notifications[index].read) {
        notifications[index].read = true;
        unreadNotifications--;
        updateNotificationCount();
    }
}

function markAllNotificationsAsRead() {
    notifications.forEach(notif => {
        if (!notif.read) {
            notif.read = true;
        }
    });
    unreadNotifications = 0;
    updateNotificationCount();
    updateNotificationDisplay();
}

notificationIconDiv.addEventListener('click', (event) => {
    event.stopPropagation();
    notificationPopupDiv.style.display = 'block';
    fullNotificationPopupDiv.style.display = 'none';
    currentNotificationIndex = null;
});

document.addEventListener('click', (event) => {
    if (!notificationIconDiv.contains(event.target) && !notificationPopupDiv.contains(event.target) && !fullNotificationPopupDiv.contains(event.target)) {
        notificationPopupDiv.style.display = 'none';
        fullNotificationPopupDiv.style.display = 'none';
        currentNotificationIndex = null;
    }
});

closeNotificationPopup.addEventListener('click', (event) => {
    notificationPopupDiv.style.display = 'none';
    fullNotificationPopupDiv.style.display = 'none';
    currentNotificationIndex = null;
    event.stopPropagation();
});

fullNotificationCloseButton.addEventListener('click', (event) => {
    fullNotificationPopupDiv.style.display = 'none';
    event.stopPropagation();
});

markAllReadButton.addEventListener('click', (event) => {
    markAllNotificationsAsRead();
    event.stopPropagation();
});

function addNoteToFirebase(text, topic) {
    addNotification({
        title: `Catatan baru: ${text.substring(0, 20)}...`,
        message: `Isi lengkap catatan: ${text}`,
        read: false,
        type: topic === 'maintenance' ? 'maintenance' : topic === 'blog' ? 'blog' : 'umum',
        fullText: text
    });
}



function showFullNotificationPopup(index) {
    const notif = notifications[index];
    if (notif) {
        let categoryText = '';
        let categoryColor = '';
        let textColor = '';

        if (notif.type === 'maintenance') {
            categoryText = '[maintenance]';
            categoryColor = '#ffe082';
            textColor = '#7a5206';
        } else if (notif.type === 'blog') {
            categoryText = '[blog & note]';
            categoryColor = '#b2ebf2';
            textColor = '#006064';
        } else {
            categoryText = '[Info Umum]';
            categoryColor = '#d1c4e9';
            textColor = '#311b92';
        }

        const fullTextWithLinks = notif.fullText
            .replace(/(https?:\/\/[^\s]+)/g, `<a href="$1" style="color: blue; text-decoration: underline;">$1</a>`);

        // Fungsi untuk membuat blok warna
        const createColoredBlock = (title, content, color) => {
            return `<div style="background-color: ${color}; padding: 10px; border-radius: 4px; margin-bottom: 10px;">
                        <h4 style="margin-top: 0; margin-bottom: 5px; font-weight: bold;">${title}</h4>
                        <p style="margin-bottom: 0;">${content}</p>
                    </div>`;
        };

        let fullTextContent = '';
        if (notif.title) {
            fullTextContent += createColoredBlock("Title", notif.title, '#f0f4c3');
        }
        if (notif.message) {
            fullTextContent += createColoredBlock("Message", notif.message, '#e0f7fa');
        }
        if (notif.tanggal) {
            fullTextContent += createColoredBlock("Tanggal", notif.tanggal, '#f8bbd0');
        }
        if (notif.deskripsi) {
            fullTextContent += createColoredBlock("Deskripsi", notif.deskripsi, '#d1c4e9');
        }
        if (notif.link) {
            fullTextContent += `<div style="margin-top: 10px; font-size: 0.9em;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right-circle-fill" viewBox="0 0 16 16" style="margin-right: 5px; vertical-align: middle; display: inline-block; transform: rotate(45deg);">
                                        <path d="M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm3.964 8.56l-5.146 2.573a.5.5 0 0 1-.72-.488v-5.146a.5.5 0 0 1 .72-.487l5.146 2.573z"/>
                                    </svg>
                                    <a href="${notif.link}" style="color: blue; text-decoration: underline;">${notif.linkText || 'Pelajari Selengkapnya'}</a>
                                </div>`;
        }


        fullNotificationContentDiv.innerHTML = `
            <div style="position: relative;">
                <div style="background-color: ${categoryColor}; color: ${textColor}; padding: 8px; border-radius: 4px; margin-bottom: 10px; font-weight: bold; text-align: center;">
                    ${categoryText}
                </div>
                <h3 style="color: ${textColor}; margin-bottom: 10px;">${notif.title || 'Tidak Ada Judul'}</h3>
                <div style="text-align: left;">
                    ${fullTextContent}
                    ${notif.imageUrl ? `<div style="margin-top: 10px;"><img src="${notif.imageUrl}" alt="Notification Image" style="max-width: 100%; border-radius: 8px;"></div>` : ''}
                </div>
                <button style="position: absolute; top: 10px; right: 10px; border: none; background: none; font-size: 1.5em; cursor: pointer; color: #888;" onclick="this.parentNode.parentNode.style.display='none';">√ó</button>
            </div>
        `;
        fullNotificationPopupDiv.style.display = 'block';
        currentNotificationIndex = index;
    }
}

// Contoh penambahan notifikasi
addNotification({
    type: 'maintenance',
    title: 'Transaksi Berhasil',
    message: 'Pembayaran Anda telah berhasil diproses.',
    tanggal: '07 Mei 2025 pukul 13:00 WIB',
    deskripsi: 'Status: Berhasil',
    fullText: `
        
        <p>Terima kasih telah melakukan transaksi.</p>
    `,
    read: false,
    imageUrl: 'https://placehold.co/600x400/EEE/31343C',
});
addNotification({
    type: 'blog',
    title: 'Pengumuman Event Seru!',
    message: 'Jangan lewatkan event mingguan kami dengan hadiah menarik.',
    tanggal: 'Setiap hari Sabtu',
    deskripsi: 'Dapatkan kesempatan memenangkan hadiah menarik!',
    fullText: `
        
        <p>Segera daftarkan diri Anda!</p>
    `,
    read: false,
    imageUrl: 'https://placehold.co/600x400/EEE/31343C',
});
addNotification({
    type: 'umum',
    title: 'Informasi Pemeliharaan Sistem',
    message: 'Sistem akan dalam pemeliharaan pada tanggal 9 Mei 2025.',
    tanggal: '9 Mei 2025, 22:00 - 23:00 WIB',
    deskripsi: 'Mohon maaf atas ketidaknyamanannya.',
    fullText: `
        
    `,
    read: false,
    imageUrl: 'https://placehold.co/600x400/EEE/31343C',
});
addNotification({
    type: 'maintenance',
    title: 'Transaksi Uji Coba',
    message: 'Ini adalah pesan uji coba transaksi.',
    tanggal: '10 Mei 2025',
    deskripsi: 'Waktu: 14:00 WIB',
    fullText: `
        
        <p>Terima kasih telah melakukan uji coba transaksi.</p>
        
    `,
    read: false,
    imageUrl: 'https://placehold.co/600x400/EEE/31343C',
});

addNotification({
    type: 'blog',
    title: 'Event Uji Coba',
    message: 'Ini adalah pesan uji coba event.',
    tanggal: '12 Mei 2025',
    deskripsi: 'Deskripsi: Ini adalah event uji coba yang menarik.',
    fullText: `
        
        <p>Jangan lewatkan kesempatan untuk berpartisipasi dalam event uji coba ini.</p>
        
    `,
    read: false,
    imageUrl: 'https://placehold.co/600x400/EEE/31343C',
});

updateNotificationDisplay();
updateNotificationCount();


    
     

   
   
   
   
   
   
   
   
   
   
   
   
   




const blogListDiv = document.getElementById("blogList");
const blogContentArea = document.getElementById("blogContentArea");
const blogContentTitle = document.getElementById("blogContentTitle");
const blogContent = document.getElementById("blogContent");
const closeBlogContentBtn = document.getElementById("closeBlogContent");
const paginationList = document.querySelector(".pagination-list");
const paginationNext = document.querySelector(".pagination-next-link");
const showQuoraTitlesBtn = document.getElementById("showQuoraTitles");


let currentPage = 1;
const articlesPerPage = 5;
let totalPages = 0;
let currentDisplayedArticles = []; // Untuk menyimpan artikel yang sedang ditampilkan


const blogArticles = [
    {
        id: "blog-1",
        title: "Siapa Farid Ardiansyah?",
        content: `.

        <ul>
            <li></li>
            <li></li>
            <li></li>
        </ul>

        ....

        .

        .

        Seperti jawaban <a href="" style="text-decoration: underline; text-color: black; "></a>  <a href="" style="text-decoration: underline;"></a> .

        <div style="background-color: yellow; padding: 15px; border-left: 4px solid black; margin: 10px 0;">
            .
        </div>

        .

      

        <div style="text-align: center;">
            <img src="images/5.jpg" alt="Elon Musk on Mars" style="width: 80%; max-width: 500px;">
        </div>

        .
        .

        .

        <div style="position: relative; display: inline-block; margin-top: 10px;">
           <iframe width="560" height="315" 
  src="https://www.youtube.com/embed/cTPYUox41bU" 
  title="YouTube video player" 
  frameborder="0" 
  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
  allowfullscreen>
</iframe>

            <a href="https://www.youtube.com/watch?v=cTPYUox41bU&t=2s" target="_blank" style="position: absolute; left: 50%; top: 100%; transform: translateX(-50%); margin-top: 5px; color: #000; font-size: 0.7em;">Tonton di YouTube</a>
        </div>

        <div style="background-color: yellow; padding: 15px; border-left: 4px solid red; margin: 10px 0;">
            .
        </div>

        .

        .

        .
		
		
		 <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px; margin-bottom: 10px;">
            <span style="background-color: green; padding: 5px 10px; border-radius: 15px; font-size: 29px;"></span>
            <span style="background-color: red; padding: 5px 10px; border-radius: 15px; font-size: 29px;"></span>
            <span style="background-color: yellow; padding: 5px 10px; border-radius: 15px; font-size: 29px;"></span>
        </div>


        <a href="#" style="text-decoration: underline; color: #000; font-size: 29px; ">Previous : ?</a>`,
        category: "Self",
        date: "May 08, 2025",
        source: "Quora"
    },
    {
        id: "blog-2",
        title: "Coming Soon",
        content: "Coming Soon.",
        category: "Self",
        date: "May 08, 2025",
        source: "Quora"
    },
    {
        id: "blog-3",
        title: "Coming Soon",
        content: "Coming Soon.",
        category: "Arduino",
        date: "May 08, 2025",
        source: "Quora"
    },
    {
        id: "blog-4",
        title: "Coming Soon",
        content: "Coming Soon.",
        category: "IoT",
        date: "May 08, ¬†2025",
        source: "Quora"
    },
    {
        id: "blog-5",
        title: "Coming Soon?",
        content: "Coming Soon.",
        category: "Others",
        date: "May 08, 2025",
        source: "Quora"
    },
    {
        id: "blog-6",
        title: "Coming Soon?",
        content: "Coming Soon.",
        category: "Others",
        date: "May 08, 2025",
        source: "Quora"
    },
];

	
	function displayArticles(page, articlesToDisplay = blogArticles) {
    blogListDiv.innerHTML = '';
    const startIndex = (page - 1) * articlesPerPage;
    const endIndex = startIndex + articlesPerPage;
    const currentArticles = articlesToDisplay.slice(startIndex, endIndex);
    currentDisplayedArticles = articlesToDisplay; // Update artikel yang sedang ditampilkan

    const categories = ["Self", "Arduino", "IoT", "Others"];

    categories.forEach(category => {
        const categoryArticles = currentArticles.filter(article => article.category === category);

        if (categoryArticles.length > 0) {
            const categoryTitle = document.createElement('h2');
            categoryTitle.classList.add('blog-category-title');
            categoryTitle.textContent = category;
            // blogListDiv.appendChild(categoryTitle); // Kategori tidak ditampilkan

            const articleList = document.createElement('div');
            articleList.classList.add('article-list');

            categoryArticles.forEach(article => {
                const articleItem = document.createElement('div');
                articleItem.classList.add('article-item');
                articleItem.innerHTML = `
                    <div class="category-container">
                        <h3 class="blog-title" data-blog-id="${article.id}">${article.title}</h3>
                        <div style="display: flex; flex-direction: column; align-items: flex-end;">
                            <span class="blog-date">${article.date}</span>
                            <span class="blog-source">${article.source}</span>
                        </div>
                    </div>
                `;
                articleList.appendChild(articleItem);
            });
            blogListDiv.appendChild(articleList);

            const categoryDivider = document.createElement('div');
            categoryDivider.classList.add('category-divider');
            blogListDiv.appendChild(categoryDivider);
        }
    });

    // Event listener untuk menampilkan konten blog saat judul diklik
    blogListDiv.addEventListener('click', function (event) {
        const target = event.target;
        if (target.classList.contains('blog-title')) { // Pastikan yang diklik adalah judul
            const blogId = target.dataset.blogId;
            const selectedArticle = blogArticles.find(article => article.id === blogId);
            if (selectedArticle) {
                // ... (kode untuk menampilkan popup konten) ...
            }
        }
    });
}

    // Event listener untuk menampilkan konten blog saat judul diklik
    blogListDiv.addEventListener('click', function (event) {
        const target = event.target;
        if (target.classList.contains('blog-title')) { // Pastikan yang diklik adalah judul
            const blogId = target.dataset.blogId;
            const selectedArticle = blogArticles.find(article => article.id === blogId);
            if (selectedArticle) {
                // Gunakan innerHTML untuk memasukkan judul, tanggal, sumber, dan konten
                blogContentArea.innerHTML = `
                    <div id="blog-content-popup" style="display:none;
                        position: fixed;
                        top: 50%;
                        left: 50%;
                        transform: translate(-50%, -50%);
                        background-color: white;
                        padding: 20px;
                        border: 1px solid #ccc;
                        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
                        z-index: 10;
                        width: 90%;  /* Increased width */
                        max-width: 90vw; /* Ensure it doesn't overflow */
                        height: auto; /* Let height adjust to content */
                        max-height: 90vh; /* Added max-height for very large screens */
                        overflow-y: auto;">
                        <h2 class="blog-content-main-title">${selectedArticle.title}</h2>
                        <div class="blog-content-meta">
                            <span class="blog-content-date">${selectedArticle.date}</span>
                            <span class="blog-content-source">Sumber: ${selectedArticle.source}</span>
                        </div>
                        <div class="blog-content-text">${selectedArticle.content}</div>
                        <button id="close-popup" style="margin-top: 15px;">Tutup</button>
                    </div>
                `;

                // Tambahkan ini ke body, bukan ke blogContentArea
                document.body.appendChild(blogContentArea);

                const popup = document.getElementById('blog-content-popup');
                const closePopupBtn = document.getElementById('close-popup');
                const youtubePlaceholder = document.getElementById('youtube-placeholder');


                popup.style.display = 'block';

                closePopupBtn.addEventListener('click', () => {
                    popup.style.display = 'none';
                    // Bersihkan konten video saat popup ditutup.
                    if (youtubePlaceholder) {
                        youtubePlaceholder.innerHTML = `<svg style="width: 60px; height: 40px; fill: white; filter: drop-shadow(0 0 6px rgba(0,0,0,0.6));" viewBox="0 0 68 48"><path d="M66.52 7.74c-.78-2.93-2.49-5.41-5.42-6.19C55.79.13 34 0 34 0S12.21.13 6.9 1.55c-2.93.78-4.64 3.26-5.42 6.19C.06 13.05 0 24 0 24s.06 10.95 1.48 16.26c.78 2.93 2.49 5.41 5.42 6.19C12.21 47.87 34 48 34 48s21.79-.13 27.1-1.55c2.93-.78 4.64-3.26 5.42-6.19C67.94 34.95 68 24 68 24s-.06-10.95-1.48-16.26z"></path><path d="M27 33.7v-22.18c0-1.16.96-2.08 2.16-1.44l24.32 11.09c1.2 0.55 1.2 1.91 0 2.46L29.16 35.14c-1.2 0.62-2.16-.3-2.16-1.44z"></path></svg>`;
                    }
                });

                youtubePlaceholder.addEventListener('click', () => {
                    youtubePlaceholder.innerHTML = `<iframe width="100%" height="100%" src="https://www.youtube.com/embed/dQw4w9WgXcQ" frameborder="0" allow="autoplay; encrypted-media; picture-in-picture" allowfullscreen></iframe>`;
                });
            }
        }
    });


function updatePagination() {
    paginationList.innerHTML = '';
    totalPages = Math.ceil(currentDisplayedArticles.length / articlesPerPage); // Gunakan artikel yang sedang ditampilkan

    if (totalPages <= 1) {
        paginationNext.style.display = 'none';
        return; // No pagination needed if there's only one page
    } else {
        paginationNext.style.display = 'block';
    }

    for (let i = 1; i <= totalPages; i++) {
        const pageItem = document.createElement('li');
        pageItem.classList.add('pagination-item');
        if (i === currentPage) {
            pageItem.classList.add('active');
        }
        const pageLink = document.createElement('a');
        pageLink.classList.add('pagination-link');
        pageLink.href = '#';
        pageLink.textContent = i;
        pageLink.style.color = '#000';
        pageLink.addEventListener('click', (e) => {
            e.preventDefault();
            currentPage = i;
            displayArticles(currentPage, currentDisplayedArticles); // Pass artikel yang sedang ditampilkan
            updatePagination();
        });
        pageItem.appendChild(pageLink);
        paginationList.appendChild(pageItem);
    }


    // Disable "Next Page" button if on the last page
    if (currentPage === totalPages) {
        paginationNext.classList.add('disabled');
        paginationNext.onclick = function (e) {
            e.preventDefault();
        };
    } else {
        paginationNext.classList.remove('disabled');
        paginationNext.onclick = function () {
            nextPage();
        };
    }
}

function nextPage() {
    if (currentPage < totalPages) {
        currentPage++;
        displayArticles(currentPage, currentDisplayedArticles); // Pass artikel yang sedang ditampilkan
        updatePagination();
    }
}

const quoraPopup = document.getElementById('quoraPopup');
const quoraTitleList = document.getElementById('quoraTitleList');
const closeQuoraPopupBtn = document.getElementById('closeQuoraPopup');

function showQuoraTitles() {
    console.log('showQuoraTitles dijalankan');
    const quoraArticles = blogArticles.filter(article => article.source.toLowerCase() === "quora");
    console.log('Jumlah artikel Quora:', quoraArticles.length);
    console.log('Isi artikel Quora:', quoraArticles);

    // Bersihkan daftar sebelumnya
    quoraTitleList.innerHTML = '';

    // Tambahkan judul Quora ke dalam daftar
    quoraArticles.forEach(article => {
        const listItem = document.createElement('li');
        listItem.innerHTML = `
            <h3 class="blog-title-popup" data-blog-id="${article.id}" style="font-size: 1.2em; margin-bottom: 5px; cursor: pointer;">
                ${article.title}
            </h3>
            <div style="font-size: 0.8em; color: #777; margin-bottom: 8px;">
                ${article.date} ‚Äî in ${article.source}
            </div>
            ${article.id === 'blog-1' ? `<div style="margin-top: 5px; font-size: 0.9em; color: #777;">${blogArticles.find(item => item.id === 'blog-1').content.substring(0, 100)}...</div>` : ''}
        `;
        quoraTitleList.appendChild(listItem);
    });

    // Tampilkan popup
    quoraPopup.style.display = 'block';
}

// Event listener untuk menutup popup (tetap sama)
closeQuoraPopupBtn.addEventListener('click', () => {
    quoraPopup.style.display = 'none';
});

// Event listener untuk tombol "Tampilkan Judul Quora" (tetap sama)
showQuoraTitlesBtn.addEventListener('click', showQuoraTitles);

// Event listener untuk menampilkan konten blog saat judul diklik (baik di daftar utama maupun di popup)
blogListDiv.addEventListener('click', handleTitleClick);
quoraTitleList.addEventListener('click', handleTitleClick);

function handleTitleClick(event) {
    const target = event.target;
    if (target.classList.contains('blog-title') || target.classList.contains('blog-title-popup')) {
        const blogId = target.dataset.blogId;
        const selectedArticle = blogArticles.find(article => article.id === blogId);
        if (selectedArticle) {
            // Gunakan innerHTML untuk memasukkan judul, tanggal, sumber, dan konten ke dalam blogContentArea
            blogContentArea.innerHTML = `
                <div id="blog-content-popup" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: white; padding: 20px; border: 1px solid #ccc; box-shadow: 0 4px 8px rgba(0,0,0,0.2); z-index: 10; width: 90%; max-width: 90vw; height: auto; max-height: 90vh; overflow-y: auto;">
                    <h2 class="blog-content-main-title">${selectedArticle.title}</h2>
                    <div class="blog-content-meta">
                        <span class="blog-content-date">${selectedArticle.date}</span>
                        <span class="blog-content-source">Sumber: ${selectedArticle.source}</span>
                    </div>
                    <div class="blog-content-text">${selectedArticle.content}</div>
                    <button id="close-popup" style="margin-top: 15px;">Tutup</button>
                </div>
            `;

            // Tambahkan popup konten ke body
            document.body.appendChild(blogContentArea);

            const popup = document.getElementById('blog-content-popup');
            const closePopupBtn = document.getElementById('close-popup');

            popup.style.display = 'block';

            closePopupBtn.addEventListener('click', () => {
                popup.style.display = 'none';
            });
        }
    }
}


const tagFilterPopup = document.getElementById('tagFilterPopup');
const tagFilterTitle = document.getElementById('tagFilterTitle');
const tagArticleList = document.getElementById('tagArticleList');
const closeTagFilter = document.getElementById('closeTagFilter');
const blogTagElements = document.querySelectorAll('.blog-tag');

blogTagElements.forEach(tagElement => {
    tagElement.addEventListener('click', function() {
        const selectedTag = this.dataset.tag;
        const filteredArticles = filterArticlesByTagForPopup(selectedTag);
        displayFilteredArticlesInPopup(selectedTag, filteredArticles);
        tagFilterPopup.style.display = 'block';
    });
});

closeTagFilter.addEventListener('click', () => {
    tagFilterPopup.style.display = 'none';
});

function filterArticlesByTagForPopup(tag) {
    return blogArticles.filter(article =>
        article.content.toLowerCase().includes(tag.toLowerCase()) ||
        article.title.toLowerCase().includes(tag.toLowerCase())
        // Anda bisa menambahkan kondisi pencarian lain di sini jika perlu,
        // misalnya mencari di array tags jika Anda menambahkannya ke objek artikel.
    );
}

function displayFilteredArticlesInPopup(tag, articles) {
    tagFilterTitle.textContent = `Artikel dengan Tag: ${tag}`;
    tagArticleList.innerHTML = '';
    if (articles.length === 0) {
        tagArticleList.innerHTML = '<p>Tidak ada artikel dengan tag ini.</p>';
        return;
    }
    articles.forEach(article => {
        const listItem = document.createElement('li');
        listItem.style.marginBottom = '10px';
        listItem.innerHTML = `
            <h3 class="blog-title-popup" data-blog-id="${article.id}" style="font-size: 1.2em; margin-bottom: 5px; cursor: pointer;">
                ${article.title}
            </h3>
            <div style="font-size: 0.8em; color: #777;">
                ${article.date} ‚Äî in ${article.source}
            </div>
            ${article.id === 'blog-1' ? `<div style="margin-top: 5px; font-size: 0.9em; color: #777;">${blogArticles.find(item => item.id === 'blog-1').content.substring(0, 100)}...</div>` : ''}
        `;
        listItem.addEventListener('click', (event) => {
            handleTitleClick(event); // Gunakan fungsi yang sama untuk menampilkan konten blog
            tagFilterPopup.style.display = 'none'; // Tutup popup filter setelah artikel diklik
        });
        tagArticleList.appendChild(listItem);
    });
}




// Initial display (tetap menampilkan berdasarkan kategori)
displayArticles(currentPage);
updatePagination();








// Definisi kata kunci dan panduan topik
         const topicKeywords = {
            makanan: {
                keywords: ["makan", "sarapan", "siang", "malam", "restoran", "kafe", "masak", "nasi", "roti", "buah", "sayur", "daging", "ikan", "minum", "kopi", "teh", "lezat", "enak", "lapar", "kenyang"],
                guide: "Catat semua hal yang berkaitan dengan makanan di sini. Mulai dari resep, daftar belanja, hingga ulasan restoran favoritmu.",
activity: {}, // Tambahkan data aktivitas jika ada
                link: "https://id.wikipedia.org/wiki/Makanan", // Tambahkan koma di sini
                 termsContent: [
            "Ketentuan terkait topik makanan:...",
            "[gambar]images/5.jpg", // Indikasi gambar dan path
            "Informasi tambahan tentang makanan:...",
            "Tips dan trik untuk catatan makanan:..."
        ]
            },
            belajar: {
                keywords: ["belajar", "kuliah", "sekolah", "ujian", "buku", "catatan", "materi", "soal", "paham", "mengerti", "ilmu", "edukasi", "kursus", "pelajaran", "guru", "dosen"],
                guide: "Gunakan topik ini untuk mencatat materi pelajaran, tugas, atau ide-ide saat belajar.",
activity: {
            Jan: [
                { day: "Mon", status: "baru", date: "2025-01-06" },
                { day: "Wed", status: "selesai", date: "2025-01-08" }
                // ... data lain di bulan Januari
            ],
            Feb: [
                { day: "Fri", status: "selesai", date: "2025-02-14" }
                // ... data lain di bulan Februari
            ],
            // ... bulan-bulan lain
			Mar: [
                { day: "Fri", status: "selesai", date: "2025-03-14" }
                // ... data lain di bulan Februari
            ],
            // ... bulan-bulan lain
			Apr: [
                { day: "Fri", status: "revisi", date: "2025-04-14" },
				{ day: "Fri", status: "selesai", date: "2025-04-25" }
                // ... data lain di bulan Februari
            ],
            // ... bulan-bulan lain
        },
 
                link: "https://id.wikipedia.org/wiki/Pendidikan"
            },

                
            pekerjaan: {
                keywords: ["kerja", "kantor", "meeting", "proyek", "deadline", "tugas", "karir", "gaji", "bos", "rekan kerja", "laporan", "presentasi", "wawancara", "promosi", "bisnis"],
                guide: "Catat semua hal terkait pekerjaanmu, seperti ide proyek, catatan rapat, atau daftar tugas.",
activity: {
            Jan: [
                { day: "Mon", status: "baru", date: "2026-01-06" },
                { day: "Wed", status: "selesai", date: "2026-01-08" }
                // ... data lain di bulan Januari
            ],
            Feb: [
                { day: "Fri", status: "selesai", date: "2026-02-14" }
                // ... data lain di bulan Februari
            ],
            // ... bulan-bulan lain
			Mar: [
                { day: "Fri", status: "selesai", date: "2026-03-14" }
                // ... data lain di bulan Februari
            ],
            // ... bulan-bulan lain
			Apr: [
                { day: "Fri", status: "revisi", date: "2026-04-14" },
				{ day: "Fri", status: "selesai", date: "2026-04-25" }
                // ... data lain di bulan Februari
            ],
            // ... bulan-bulan lain
        },
 
                link: "https://id.wikipedia.org/wiki/Pendidikan"
            },
			
			
            hiburan: {
                keywords: ["nonton", "film", "musik", "konser", "game", "buku", "komik", "liburan", "jalan-jalan", "pesta", "tertawa", "senang", "bahagia", "santai"],
                guide: "Tempat untuk mencatat ide film, buku yang ingin dibaca, atau rencana liburanmu.",
activity: {}, // Tambahkan data aktivitas jika ada
                link: "https://id.wikipedia.org/wiki/Hiburan"
            },
            kesehatan: {
                keywords: ["sehat", "sakit", "dokter", "obat", "olahraga", "bugar", "istirahat", "tidur", "vitamin", "diet", "alergi", "demam", "flu", "stres"],
                guide: "Catat informasi kesehatan penting, jadwal olahraga, atau gejala yang kamu rasakan.",
activity: {}, // Tambahkan data aktivitas jika ada
                link: "https://id.wikipedia.org/wiki/Kesehatan"
            },
            cinta: {
                keywords: ["cinta", "sayang", "pacar", "hubungan", "hati", "perasaan", "rindu", "kangen", "putus", "nikah", "kasih", "mesra", "romantis"],
                guide: "Curahkan isi hatimu dan catatan tentang hubunganmu di sini.",
activity: {}, // Tambahkan data aktivitas jika ada
                link: "https://id.wikipedia.org/wiki/Cinta"
            },
            lainlain: {
                keywords: [],
                guide: "Catatan yang tidak termasuk dalam kategori lain akan dikumpulkan di sini.",
activity: {}, // Tambahkan data aktivitas jika ada
                link: "#"
            }
        };



       

¬† ¬† ¬† ¬† function categorizeNote(text) {
¬† ¬† ¬† ¬† ¬† ¬† const lowerCaseText = text.toLowerCase();
¬† ¬† ¬† ¬† ¬† ¬† for (const topic in topicKeywords) {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† if (topicKeywords[topic].keywords.some(keyword => lowerCaseText.includes(keyword))) {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† return topic;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† ¬† ¬† return "lainlain";
¬† ¬† ¬† ¬† }

¬† ¬† ¬† ¬† async function addNote() {
    const text = noteInput.value.trim();
    if (!text) return;

    const topic = categorizeNote(text);

    try {
        const newNoteRef = await addDoc(notesRef, { text, topic, createdAt: serverTimestamp() });
        noteInput.value = "";
        showPopup();

        // Dapatkan timestamp catatan baru
        const noteDoc = await getDoc(newNoteRef);
        const createdAt = noteDoc.data().createdAt.toDate();
        const year = createdAt.getFullYear();
        const month = new Intl.DateTimeFormat('en', { month: 'short' }).format(createdAt);
        const day = String(createdAt.getDate()).padStart(2, '0');
        const dateString = `${year}-${String(createdAt.getMonth() + 1).padStart(2, '0')}-${day}`;

        // Perbarui data aktivitas (ini adalah contoh sederhana, perlu disesuaikan dengan struktur data Anda)
        if (topicKeywords[topic] && topicKeywords[topic].activity && topicKeywords[topic].activity[month]) {
            const existingActivity = topicKeywords[topic].activity[month].find(item => item.date === dateString);
            if (!existingActivity) {
                topicKeywords[topic].activity[month].push({ date: dateString, status: 'new' });
                // Anda mungkin perlu cara untuk menandai ini sebagai 'updated' agar tampilan di-refresh
            }
            // Refresh tampilan catatan untuk topik ini (perlu implementasi yang lebih baik)
            const q = query(notesRef, orderBy("createdAt"));
            onSnapshot(q, snapshot => {
                const allNotes = snapshot.docs;
                const filteredNotes = currentFilter === "semua" ? allNotes : allNotes.filter(doc => (doc.data().topic || "lainlain").toLowerCase() === currentFilter);
                displayNotes(filteredNotes, document.querySelector(`#activityYear-${topic}`).value); // Pertahankan tahun yang dipilih
            });

        }

    } catch (error) {
        alert("Gagal menyimpan: " + error.message);
        console.error(error);
    }
}

¬† ¬† ¬† ¬† function showPopup() {
¬† ¬† ¬† ¬† ¬† ¬† popup.classList.add("show");
¬† ¬† ¬† ¬† ¬† ¬† setTimeout(() => popup.classList.remove("show"), 2000);
¬† ¬† ¬† ¬† }

¬† ¬† ¬† ¬† 
function displayNotes(notes) {
    noteList.innerHTML = "";
    const groupedNotes = {};
    const topicCounts = {};

    notes.forEach(doc => {
        const topic = doc.data().topic || "lainlain";
        if (!groupedNotes[topic]) {
            groupedNotes[topic] = [];
        }
        groupedNotes[topic].push(doc);
        topicCounts[topic] = (topicCounts[topic] || 0) + 1;
    });

    const sortedTopics = Object.keys(groupedNotes).sort((a, b) => (topicCounts[b] || 0) - (topicCounts[a] || 0));
    const mostFrequentTopic = sortedTopics[0];

    const recentNotes = notes.slice().sort((a, b) => b.data().createdAt - a.data().createdAt).slice(0, 5);
    if (recentNotes.length > 0) {
        const recentNotesDiv = document.createElement("div");
        recentNotesDiv.className = "note-group";
        const heading = document.createElement("h2");
        heading.textContent = "Catatan Terbaru";
        recentNotesDiv.appendChild(heading);
        recentNotes.forEach((doc, index) => {
            recentNotesDiv.appendChild(renderNote(doc, index === 0));
        });
        noteList.appendChild(recentNotesDiv);
    }

    sortedTopics.forEach(topic => {
        const topicDiv = document.createElement("div");
        topicDiv.className = "note-group";
        const heading = document.createElement("h2");
        const topicName = topic.charAt(0).toUpperCase() + topic.slice(1);
        const count = topicCounts[topic] || 0;
        heading.textContent = `${topicName} (${count}) ${topic === mostFrequentTopic && Object.keys(groupedNotes).length > 1 ? '‚≠ê' : ''}`; // Tambahkan jumlah di sini
        topicDiv.appendChild(heading);

        if (topic !== "lainlain" && topicKeywords[topic] && topicKeywords[topic].activity) {
            const activityTitle = document.createElement("h3");
            activityTitle.style.fontSize = "16px";
            activityTitle.style.fontWeight = "bold";
            activityTitle.style.marginTop = "10px";
            activityTitle.textContent = "Aktivitas";
            topicDiv.appendChild(activityTitle);
            const currentYear = new Date().getFullYear();
            topicDiv.innerHTML += renderActivity(topicKeywords[topic].activity, currentYear);
        }

        const notesInTopic = groupedNotes[topic];
        notesInTopic.forEach((doc, idx) => {
            const isLatest = idx === notesInTopic.length - 1 && topic === sortedTopics[sortedTopics.length - 1];
            topicDiv.appendChild(renderNote(doc, isLatest));
        });
        noteList.appendChild(topicDiv);
        if (notesInTopic.length === 0) {
            const emptyMessage = document.createElement("p");
            emptyMessage.className = "empty-topic";
            emptyMessage.textContent = "Belum ada catatan untuk topik ini.";
            topicDiv.appendChild(emptyMessage);
        }
    });

    if (Object.keys(groupedNotes).length === 0) {
        const emptyAllMessage = document.createElement("p");
        emptyAllMessage.className = "empty-topic";
        emptyAllMessage.textContent = "Belum ada catatan.";
        noteList.appendChild(emptyAllMessage);
    }

    // Perbarui juga tombol filter topik dengan jumlah catatan
    const topicFilterButtons = document.querySelectorAll('.topic-filter .topic-button');
    topicFilterButtons.forEach(button => {
        const topic = button.dataset.topic;
        if (topic === 'semua') {
            const allCount = notes.length;
            button.textContent = `Semua (${allCount})`;
        } else {
            const count = topicCounts[topic] || 0;
            const topicName = topic.charAt(0).toUpperCase() + topic.slice(1);
            button.textContent = `${topicName} (${count})`;
        }
    });
}

// Pastikan Anda mengganti 'noteList' dengan ID yang benar untuk tempat Anda menampilkan daftar topik
const topicList = document.getElementById("noteList"); // Asumsi ID-nya adalah 'noteList'

¬† ¬† ¬† ¬† const q = query(notesRef, orderBy("createdAt"));
¬† ¬† ¬† ¬† onSnapshot(q, snapshot => {
¬† ¬† ¬† ¬† ¬† ¬† const allNotes = snapshot.docs;
¬† ¬† ¬† ¬† ¬† ¬† const uniqueTopics = ["semua"];
¬† ¬† ¬† ¬† ¬† ¬† for (const topic in topicKeywords) {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† if (!uniqueTopics.includes(topic)) {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† uniqueTopics.push(topic);
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† ¬† ¬† }

¬† ¬† ¬† ¬† ¬† ¬† // Render tombol filter topik
¬† ¬† ¬† ¬† ¬† ¬† topicFilter.innerHTML = '<button class="topic-button active" data-topic="semua">Semua</button>';
¬† ¬† ¬† ¬† ¬† ¬† uniqueTopics.slice(1).forEach(topic => {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† const button = document.createElement("button");
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† button.className = "topic-button";
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† button.dataset.topic = topic;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† button.textContent = topic.charAt(0).toUpperCase() + topic.slice(1);
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† topicFilter.appendChild(button);
¬† ¬† ¬† ¬† ¬† ¬† });

¬† ¬† ¬† ¬† ¬† ¬† const filteredNotes = currentFilter === "semua" ? allNotes : allNotes.filter(doc => (doc.data().topic || "lainlain").toLowerCase() === currentFilter);
¬† ¬† ¬† ¬† ¬† ¬† displayNotes(filteredNotes);
¬† ¬† ¬† ¬† });

¬† ¬† ¬† ¬† saveBtn.addEventListener("click", addNote);
¬† ¬† ¬† ¬† noteInput.addEventListener("keydown", (e) => {
¬† ¬† ¬† ¬† ¬† ¬† if (e.key === "Enter") addNote();
¬† ¬† ¬† ¬† });

topicFilter.addEventListener("click", (event) => {
    if (event.target.classList.contains("topic-button")) {
        document.querySelectorAll(".topic-button").forEach(btn => btn.classList.remove("active"));
        event.target.classList.add("active");
        currentFilter = event.target.dataset.topic;
        const q = query(notesRef, orderBy("createdAt"));
        onSnapshot(q, snapshot => {
            const allNotes = snapshot.docs;
            const filteredNotes = currentFilter === "semua" ? allNotes : allNotes.filter(doc => (doc.data().topic || "lainlain").toLowerCase() === currentFilter);
            displayNotes(filteredNotes);
        });

        // Tampilkan panduan topik yang sesuai
        const selectedTopic = event.target.dataset.topic;
        if (topicKeywords[selectedTopic] && selectedTopic !== 'semua') {
            const guideContent = document.getElementById('guideContent');
            guideContent.innerHTML = `
                <p id="guideText">${topicKeywords[selectedTopic].guide}</p>
                <p><a id="learnMoreLink" href="#" data-topic="${selectedTopic}">Pelajari Lebih Lanjut</a></p>
            `;
            guidePopup.classList.add("show");
            overlay.classList.add("show");

            // Tambahkan event listener untuk tombol "Pelajari Lebih Lanjut" di panduan
            const learnMoreBtn = document.getElementById('learnMoreLink');
            if (learnMoreBtn) {
                learnMoreBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    const currentTopic = e.target.dataset.topic;
                    showTermsModal(currentTopic);
                });
            }
        } else {
            guidePopup.classList.remove("show");
            overlay.classList.remove("show");
        }
    }
});
¬† ¬† ¬† ¬† closeGuideBtn.addEventListener("click", () => {
¬† ¬† ¬† ¬† ¬† ¬† guidePopup.classList.remove("show");
¬† ¬† ¬† ¬† ¬† ¬† overlay.classList.remove("show");
¬† ¬† ¬† ¬† });

¬† ¬† ¬† ¬† overlay.addEventListener("click", () => {
¬† ¬† ¬† ¬† ¬† ¬† guidePopup.classList.remove("show");
¬† ¬† ¬† ¬† ¬† ¬† overlay.classList.remove("show");
¬† ¬† ¬† ¬† });
const termsModal = document.getElementById('termsModal');
const closeTermsModalBtn = document.getElementById('closeTermsModal');
const learnMoreLinkOutside = document.getElementById('learnMoreLink');


closeTermsModalBtn.addEventListener('click', () => {
  termsModal.style.display = 'none';
  overlay.style.display = 'none';
});

window.addEventListener('click', (e) => {
  if (e.target === termsModal) {
    termsModal.style.display = 'none';
    overlay.style.display = 'none';
  }
});

function showTermsModal(topic) {
    const termsModal = document.getElementById('termsModal');
    const termsContentDiv = termsModal.querySelector('.modal-content');
    termsContentDiv.innerHTML = `
        <button class="close-btn" id="closeTermsModal">&times;</button>
        <div style="background-color: #E0F7FA; padding: 15px; border-radius: 8px; margin-bottom: 10px; text-align: left;">
            <div style="display: flex; align-items: center; margin-bottom: 5px;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px; height: 20px; margin-right: 8px;"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline></svg>
                <h2 style="font-size: 1.2em; margin: 0;">Ketentuan</h2>
            </div>
            <ol id="termsNumberedList" style="padding-left: 20px; margin-top: 10px;"></ol>
        </div>
        <div style="background-color: #FCE4EC; padding: 10px; border-radius: 6px; margin-bottom: 10px; text-align: left; font-size: 0.9em;">
            <span style="color: #E91E63;">: Halaman Ketentuan</span>
        </div>
        <div style="display: flex; align-items: center; font-size: 29px; color: #757575;">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 39px; height: 39px; margin-right: 5px;"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
            <span>Terakhir diperbarui: 21 April 2025</span>
        </div>
    `;

    const termsNumberedList = document.getElementById('termsNumberedList');
    const closeBtn = termsModal.querySelector('#closeTermsModal');

    if (topicKeywords[topic] && topicKeywords[topic].termsContent) {
        topicKeywords[topic].termsContent.forEach(content => {
            const li = document.createElement('li');
            if (content.startsWith('[gambar]')) {
                const imagePath = content.substring('[gambar]'.length).trim();
                const img = document.createElement('img');
                img.src = imagePath;
                img.style.maxWidth = '100%';
                img.style.height = 'auto';
                img.style.marginBottom = '10px';
                li.appendChild(img);
            } else {
                li.textContent = content;
            }
            termsNumberedList.appendChild(li);
        });
        termsModal.style.display = 'flex';
        overlay.style.display = 'block';
        guidePopup.classList.remove('show');

        closeBtn.addEventListener('click', () => {
            termsModal.style.display = 'none';
            overlay.style.display = 'none';
        });
    } else {
        termsNumberedList.innerHTML = '<li>Tidak ada informasi lebih lanjut untuk topik ini.</li>';
        termsModal.style.display = 'flex';
        overlay.style.display = 'block';
        guidePopup.classList.remove('show');

        closeBtn.addEventListener('click', () => {
            termsModal.style.display = 'none';
            overlay.style.display = 'none';
        });
    }
}

overlay.addEventListener('click', (e) => {
    const termsModal = document.getElementById('termsModal');
    const guidePopup = document.getElementById('guidePopup');
    if (e.target === overlay) {
        termsModal.style.display = 'none';
        guidePopup.classList.remove('show');
        overlay.style.display = 'none';
    }
});


const infoPopup = document.getElementById('info-popup');
const infoPopupText = document.getElementById('info-popup-text');
const infoCards = document.querySelectorAll('.info-card');

const infoContents = {
    ketentuan: `
        <h2><span class="info-icon">üìú</span>Ketentuan</h2>
        <div class="info-content-block info-blue-block">
            <p><strong>1.</strong>.</p>
        </div>
        <div class="info-content-block info-yellow-block">
            <p><strong>2.</strong> Pengguna diharapkan menggunakan platform ini, untuk tujuan catatan yang positif dan efektif.</p>
        </div>
        <div class="info-content-block info-red-block">
            <p><strong>3.</strong> .</p>
            <p><strong>4.</strong> Pengembang bertanggung jawab atas kesalahan pribadi pengguna yg disengaja/ga sengaja .</p>
            <img src="images/5.jpg" alt=""/>
            <p>: <a href="" target="_blank">Halaman Ketentuan</a></p>
        </div>
        <p style="text-align:right; color: black; text-align: left; margin-top:1rem;">üìÖ Terakhir diperbarui: 28 April 2025 Jam 21.30</p>
    `,
    tentang: `
        <h2><span class="info-icon">‚ÑπÔ∏è</span>Tentang Kami</h2>
        <div class="info-content-block info-green-block">
            <p><strong>1.</strong> Noted adalah platform catatan sederhana yang dirancang untuk membantu Anda mencatat ide, tugas, dan informasi penting lainnya.</p>
            <p><strong>2.</strong> Kami berkomitmen untuk menyediakan antarmuka yang bersih dan mudah digunakan agar pengalaman mencatat Anda menjadi lebih efisien.</p>
            <p><strong>3.</strong> Noted adalah inisiatif pribadi untuk belajar dan berbagi pengetahuan di bidang pengembangan web.</p>
            <img src="images/5.jpg" alt="Tentang Kami"/>
            <p>: <a href="" target="_blank">Halaman Tentang Kami</a></p>
        </div>
        <p style="text-align:right; color: black; text-align: left; margin-top:1rem;">üìÖ Terakhir diperbarui: 28 April 2025 Jam 21.30</p>
    `,
    privasi: `
        <h2><span class="info-icon">üîí</span>Kebijakan Privasi</h2>
        <div class="info-content-block info-pink-block">
            <p><strong>1.</strong> Kami tidak mengumpulkan informasi pribadi Anda kecuali yang Anda masukkan secara sukarela ke dalam catatan.</p>
            <p><strong>2.</strong> Catatan Anda disimpan secara database online di perangkat website noted dan tidak dibagikan dengan pihak ketiga tanpa izin eksplisit Anda.</p>
            <p><strong>3.</strong> Kami menghormati privasi Anda dan berkomitmen untuk melindungi informasi yang Anda simpan di platform ini.</p>
            <p><strong>4.</strong> Untuk detail lebih lanjut mengenai bagaimana data Anda ditangani, silakan merujuk ke kebijakan privasi lengkap kami.</p>
            <img src="images/5.jpg" alt="Privasi"/>
            <p>Lihat kebijakan privasi lengkap: <a href="" target="_blank">Kebijakan Privasi</a>.</p>
        </div>
        <p style="text-align:right; color: black; text-align: left; margin-top:1rem;">üìÖ Terakhir diperbarui: 28 April 2025 Jam 21.30</p>
    `
};

function openInfoPopup(type) {
    if (infoContents[type]) {
        infoPopupText.innerHTML = `
            <button class="info-close-btn" onclick="closeInfoPopup()">√ó</button>
            ${infoContents[type]}
        `;
        infoPopup.style.display = 'flex';
    }
}

function closeInfoPopup() {
    infoPopup.style.display = 'none';
}

infoCards.forEach(card => {
    card.addEventListener('click', function() {
        const type = this.dataset.type;
        openInfoPopup(type);
    });
});

infoPopup.addEventListener('click', function(e) {
    if (e.target === this) {
        closeInfoPopup();
    }
});

  
  document.addEventListener("DOMContentLoaded", function () {
    const roleDescriptions = {
      admin: {
        label: "Admin",
        desc: "Admin memiliki akses penuh terhadap sistem, termasuk manajemen user dan kontrol konten.",
        colorClass: "admin"
      },
      kontributor: {
        label: "Kontributor",
        desc: "Kontributor dapat menambah atau mengedit konten namun tidak memiliki kontrol admin.",
        colorClass: "kontributor"
      },
      member: {
        label: "Member",
        desc: "Member adalah pengguna biasa yang bisa melihat konten dan memberikan komentar.",
        colorClass: "member"
      }
    };

    document.querySelectorAll(".badge").forEach(badge => {
      badge.addEventListener("click", function () {
        let role = null;
        if (this.classList.contains("admin")) role = "admin";
        if (this.classList.contains("kontributor")) role = "kontributor";
        if (this.classList.contains("member")) role = "member";

        if (!role) return;

        const popupOverlay = document.getElementById("role-popup-overlay");
        const popupBadge = document.getElementById("role-popup-badge");
        const popupDesc = document.getElementById("role-popup-desc");

        const data = roleDescriptions[role];
        popupBadge.textContent = data.label;
        popupBadge.className = `badge ${data.colorClass}`;
        popupDesc.textContent = data.desc;

        popupOverlay.classList.add("show");
      });
    });

    // Close popup
    document.getElementById("role-popup-overlay").addEventListener("click", function (e) {
      if (e.target === this || e.target.classList.contains("close-btn")) {
        this.classList.remove("show");
      }
    });
  });
  
  
function renderNote(docOrData, isLatest = false) {
    let noteData;
    let noteId;

    if (docOrData && typeof docOrData.data === 'function') {
        noteData = docOrData.data();
        noteId = docOrData.id;
    } else if (docOrData && typeof docOrData === 'object') {
        noteData = docOrData;
        noteId = docOrData.id;
    } else {
        console.warn("renderNote dipanggil dengan input yang tidak valid. Mengembalikan placeholder.");
        return document.createElement('div');
    }

    const role = noteData.role || "member";
    const isSaved = noteData.isSaved || false;
    const noteText = noteData.text || "Catatan kosong";
    const saveButtonText = isSaved ? "Disimpan" : "Simpan";
    const saveButtonClass = isSaved ? "save-individual-note saved" : "save-individual-note";
    const temaTopik = noteData.temaTopik || "lain-lain";

    const noteEl = document.createElement("div");
    noteEl.className = `note-card`;
    noteEl.dataset.topic = temaTopik.toLowerCase(); // Set data-topic, gunakan temaTopik

    noteEl.innerHTML = `
        <div class="timeline-dot ${isLatest ? "active" : ""}"></div>
        <div class="note-body">
            <div class="note-text">${noteText}</div>
            <div class="note-actions">
                <button class="${saveButtonClass}" data-id="${noteId}">
                ${saveButtonText}
                </button>
                <div class="arrow">
                <svg fill="none" stroke="#6b7280" stroke-width="2" viewBox="0 0 24 24">
                    <path d="M5 12h14M12 5l7 7-7 7" />
                </svg>
                </div>
            </div>
            <span class="badge ${role}" data-role="${role}">${role}</span>
        </div>
    `;

    const saveButton = noteEl.querySelector(".save-individual-note");
    if (saveButton) {
        saveButton.addEventListener("click", async (event) => {
        const clickedButton = event.target;
        const noteId = clickedButton.dataset.id;
        const isCurrentlySaved = clickedButton.classList.contains("saved");

        try {
            await toggleSaveNote(noteId, isCurrentlySaved, noteData);
            clickedButton.classList.toggle("saved", !isCurrentlySaved);
            clickedButton.textContent = !isCurrentlySaved ? "Disimpan" : "Simpan";
            if (savedNotesModal?.style?.display === "flex") {
            displaySavedNotesPopup();
            }
        } catch (error) {
            console.error("Error toggling save state:", error);
            alert("Failed to save note. Please try again.");
        }
        });
    }

    const badgeElement = noteEl.querySelector(".badge");
    if (badgeElement) {
        badgeElement.addEventListener("click", () => {
        showRolePopup(role);
        });
    }

    return noteEl;
}














function showRolePopup(role) {
¬† const rolePopupOverlay = document.getElementById('role-popup-overlay');
¬† const rolePopupBadge = document.getElementById('role-popup-badge');
¬† const rolePopupDesc = document.getElementById('role-popup-desc');

¬† // Tentukan deskripsi peran berdasarkan peran
¬† let description = "";
¬† switch (role) {
¬† ¬† case "admin":
¬† ¬† ¬† description = "Administrator memiliki akses penuh ke semua fitur dan pengelolaan catatan.";
¬† ¬† ¬† break;
¬† ¬† case "moderator":
¬† ¬† ¬† description = "Moderator dapat mengelola dan memoderasi catatan dalam topik tertentu.";
¬† ¬† ¬† break;
¬† ¬† case "member":
¬† ¬† ¬† description = "Member adalah pengguna biasa yang dapat melihat dan membuat catatan.";
¬† ¬† ¬† break;
¬† ¬† default:
¬† ¬† ¬† description = "Peran tidak diketahui.";
¬† }

¬† rolePopupBadge.className = `badge ${role}`;
¬† rolePopupBadge.textContent = role;
¬† rolePopupDesc.textContent = description;
¬† rolePopupOverlay.classList.add('show');
}

// Pastikan Anda memiliki event listener untuk menutup popup
const rolePopupOverlay = document.getElementById('role-popup-overlay');
if (rolePopupOverlay) {
¬† const closeButton = rolePopupOverlay.querySelector('.close-btn');
¬† if (closeButton) {
¬† ¬† closeButton.addEventListener('click', () => {
¬† ¬† ¬† rolePopupOverlay.classList.remove('show');
¬† ¬† });
¬† }
}

function renderActivity(activityData, year) {
    const monthsOrder = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
    const daysInWeek = ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"];
    let activityHTML = '<div style="overflow-x: auto;"><table style="border-collapse: collapse; font-family: sans-serif; font-size: 11px;">';

    // Header Bulan
    activityHTML += '<thead><tr><th></th>';
    monthsOrder.forEach(month => {
        const daysInMonth = getDaysInMonth(new Date(year, monthsOrder.indexOf(month), 1));
        activityHTML += `<th colspan="${daysInMonth}" style="padding: 8px; text-align: center;">${month}</th>`; // Padding lebih besar
    });
    activityHTML += '</tr></thead>';

    activityHTML += '<tbody>';
    daysInWeek.forEach(day => {
        activityHTML += `<tr><th style="padding-right: 8px; text-align: left;">${day}</th>`;
        monthsOrder.forEach(month => {
            const daysInMonth = getDaysInMonth(new Date(year, monthsOrder.indexOf(month), 1));
            for (let i = 1; i <= daysInMonth; i++) {
                const dateString = `${year}-${String(monthsOrder.indexOf(month) + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;
                const activity = activityData[month]?.find(item => item.date === dateString);
                let backgroundColor = '#000'; // Belum pernah berwarna hitam
                let tooltipText = `Belum ada aktivitas pada ${dateString}`;

                if (activity) {
                    if (activity.status === 'selesai') {
                        backgroundColor = '#40c463'; // Selesai berwarna hijau
                        tooltipText = `Selesai pada ${dateString}`;
                    } else if (activity.status === 'revisi') {
                        backgroundColor = '#ff0000'; // Revisi berwarna merah
                        tooltipText = `Direvisi pada ${dateString}`;
                    } else if (activity.status === 'baru') {
                        backgroundColor = 'yellow'; // Baru berwarna kuning (sebelumnya 'new')
                        tooltipText = `Aktivitas baru pada ${dateString}`;
                    }
                }

                activityHTML += `<td
                    style="width: 16px; height: 16px; border: 1px solid #eee; background-color: ${backgroundColor}; cursor: pointer;"
                    title="${tooltipText}"
                    data-has-activity="${activity ? 'true' : 'false'}"
                    data-status="${activity ? activity.status : ''}"
                    data-date="${dateString}"
                ></td>`;
            }
        });
        activityHTML += '</tr>';
    });

    activityHTML += '</tbody></table>';
    activityHTML += '<div style="margin-top: 5px; font-size: 10px; color: #586069;">Belum Pernah <span style="width: 10px; height: 10px; display: inline-block; background-color: #000; border: 1px solid #eee; margin: 0 5px;"></span> Baru <span style="width: 10px; height: 10px; display: inline-block; background-color: yellow; border: 1px solid #eee; margin: 0 5px;"></span> Selesai <span style="width: 10px; height: 10px; display: inline-block; background-color: #40c463; border: 1px solid #eee; margin: 0 5px;"></span> Revisi <span style="width: 10px; height: 10px; display: inline-block; background-color: #ff0000; border: 1px solid #eee; margin: 0 5px;"></span></div>';
    activityHTML += '</div>';
    return activityHTML;
}

function getDaysInMonth(date) {
    return new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();
}
document.getElementById('noteList').addEventListener('click', function(event) {
    const target = event.target;
    if (target.tagName === 'TD') {
        const hasActivity = target.dataset.hasActivity === 'true';
        const status = target.dataset.status;
        const date = target.dataset.date;

        console.log("Sel diklik - hasActivity:", hasActivity, "status:", status, "date:", date); // Tambahkan ini

        let day = '';
        let monthName = '';
        let year = '';

        if (date) {
            const [y, m, d] = date.split('-');
            year = y;
            const monthIndex = parseInt(m) - 1;
            const dateObject = new Date(year, monthIndex, parseInt(d));
            monthName = new Intl.DateTimeFormat('id-ID', { month: 'long' }).format(dateObject);
            day = d;
        }

        document.getElementById('activity-popup-title').textContent = `Ketentuan`;
        let detailsHTML = '';
        const imageUrl = 'images/5.jpg'; // Sumber gambar

        if (hasActivity) {
            let bgColor = '';
            let activityText = '';
            let linkHref = '';
            let linkText = '';

            if (status === 'selesai') {
                bgColor = '#aaff80';
                activityText = `Selamat! Catatan pada tanggal ${day} ${monthName} ${year} telah selesai.`;
                linkHref = 'https://example.com/selesai';
                linkText = 'Lihat catatan yang selesai';
            } else if (status === 'revisi') {
                bgColor = '#ffdd99';
                activityText = `Perhatian! Catatan pada tanggal ${day} ${monthName} ${year} memerlukan revisi.`;
                linkHref = 'https://example.com/revisi';
                linkText = 'Lihat catatan yang perlu direvisi';
            } else if (status === 'baru') {
                bgColor = '#ccf2ff';
                activityText = `Catatan baru ditambahkan pada tanggal ${day} ${monthName} ${year}.`;
                linkHref = 'https://example.com/baru';
                linkText = 'Lihat catatan baru';
            }

            detailsHTML = `
                <div style="background-color: ${bgColor}; padding: 15px; border-radius: 8px;">
                    <h3>${status ? status.charAt(0).toUpperCase() + status.slice(1) : 'Aktivitas'}</h3>
                    <p>${activityText}</p>
                    <img src="${imageUrl}" alt="${status || 'Aktivitas'}" style="max-width: 100%; margin-top: 10px;">
                    ${linkHref ? `<p><a href="${linkHref}" target="_blank">${linkText}</a></p>` : ''}
                </div>
            `;
        } else {
            detailsHTML = `
                <div style="background-color: #f0f0f0; padding: 15px; border-radius: 8px;">
                    <h3>Tidak Ada Aktivitas</h3>
                    <p>Belum ada aktivitas pada tanggal ${day} ${monthName} ${year}.</p>
                    <img src="${imageUrl}" alt="Tidak ada aktivitas" style="max-width: 100%; margin-top: 10px;">
                    <p><a href="https://example.com/tidak-ada" target="_blank">Pelajari lebih lanjut</a></p>
                </div>
            `;
        }

        document.getElementById('activity-popup-details').innerHTML = detailsHTML;
        document.getElementById('activity-popup-overlay').classList.add('show');
    }
});

   
   // Tanggal saat ini (auto-updates)
        const today = new Date();

        // Tanggal target: 29 Mei tahun ini
        const targetDate = new Date(today.getFullYear(), 4, 29); // Bulan 4 adalah Mei (0-indeks)

        // Jika tanggal target sudah lewat di tahun ini, atur ke tahun depan
        if (targetDate.getTime() < today.getTime()) {
            targetDate.setFullYear(today.getFullYear() + 1);
        }

        const countdownElement = document.getElementById('countdown');

        function updateCountdown() {
            const now = new Date().getTime();
            const distance = targetDate.getTime() - now;

            // Jika hitungan mundur selesai
            if (distance < 0) {
                countdownElement.innerHTML = "Happy Birthday!"; // Atau pesan lain
                clearInterval(countdownInterval);
                return;
            }

            // Perhitungan waktu
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            // Tampilkan hasil
            countdownElement.innerHTML = `${days} hari ${hours} jam ${minutes} menit ${seconds} detik lagi`;
        }

        // Panggil fungsi updateCountdown segera setelah dimuat dan setiap detik
        updateCountdown();
        const countdownInterval = setInterval(updateCountdown, 1000);

      ¬† ¬† ¬† // --- FUNGSI UNTUK POPUP (Tidak berubah, ini hanya disertakan untuk kelengkapan) ---

¬† ¬† ¬† ¬† const infoBar = document.getElementById('infoBar');

¬† ¬† ¬† ¬† const modal = document.getElementById('myModal');

¬† ¬† ¬† ¬† const closeModalBtn = document.getElementById('closeModalBtn');



¬† ¬† ¬† ¬† if (infoBar && modal && closeModalBtn) { // Pastikan elemen ada sebelum menambahkan event listener

¬† ¬† ¬† ¬† ¬† ¬† infoBar.addEventListener('click', () => {

¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† modal.classList.add('perjalanan-hidup-modal-show');

¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† document.body.style.overflow = 'hidden';

¬† ¬† ¬† ¬† ¬† ¬† });



¬† ¬† ¬† ¬† ¬† ¬† closeModalBtn.addEventListener('click', () => {

¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† modal.classList.remove('perjalanan-hidup-modal-show');

¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† document.body.style.overflow = '';

¬† ¬† ¬† ¬† ¬† ¬† });



¬† ¬† ¬† ¬† ¬† ¬† window.addEventListener('click', (event) => {

¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† if (event.target === modal) {

¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† modal.classList.remove('perjalanan-hidup-modal-show');

¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† document.body.style.overflow = '';

¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† }

¬† ¬† ¬† ¬† ¬† ¬† });

¬† ¬† ¬† ¬† }




     
    </script>
</body>
</html>
